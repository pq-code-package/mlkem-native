/* Copyright (c) 2022 Arm Limited
 * Copyright (c) 2022 Hanno Becker
 * Copyright (c) 2023 Amin Abdulrahman, Matthias Kannwischer
 * Copyright (c) The mlkem-native project authors
 * SPDX-License-Identifier: Apache-2.0 OR ISC OR MIT
 */

/* References
 * ==========
 *
 * - [NeonNTT]
 *   Neon NTT: Faster Dilithium, Kyber, and Saber on Cortex-A72 and Apple M1
 *   Becker, Hwang, Kannwischer, Yang, Yang
 *   https://eprint.iacr.org/2021/986
 *
 * - [SLOTHY_Paper]
 *   Fast and Clean: Auditable high-performance assembly via constraint solving
 *   Abdulrahman, Becker, Kannwischer, Klein
 *   https://eprint.iacr.org/2022/1303
 */

/*yaml
  Name: intt_asm
  Description: AArch64 ML-KEM inverse NTT following @[NeonNTT] and @[SLOTHY_Paper]
  Signature: void mlk_intt_asm(int16_t p[256], const int16_t twiddles12345[80], const int16_t twiddles56[384])
  ABI:
    x0:
      type: buffer
      size_bytes: 512
      permissions: read/write
      c_parameter: int16_t p[256]
      description: Input/output polynomial
    x1:
      type: buffer
      size_bytes: 160
      permissions: read-only
      c_parameter: const int16_t twiddles12345[80]
      description: Twiddle factors for layers 1-5
    x2:
      type: buffer
      size_bytes: 768
      permissions: read-only
      c_parameter: const int16_t twiddles56[384]
      description: Twiddle factors for layers 6-7
  Stack:
    bytes: 64
    description: saving callee-saved Neon registers
*/

#include "../../../common.h"
#if defined(MLK_ARITH_BACKEND_AARCH64) &&  !defined(MLK_CONFIG_MULTILEVEL_NO_SHARED)
/* simpasm: header-end */

// Bounds:
// If C is chosen so that |src| < q * C, then |dst| < q * (0.0508 * C + 1/2)

// See mlken/reduce.c and test/test_bounds.py for more details.
.macro mulmodq dst, src, const, idx0, idx1
        // Signed barrett multiplication @[NeonNTT, Section 3.1.2] using
        // round-to-nearest-even-integer approximation. Following loc.cit.,
        // this is functionally the same as a signed Montgomery multiplication
        // with a suitable constant of absolute value < q.
        sqrdmulh t2.8h,      \src\().8h, \const\().h[\idx1\()]
        mul      \dst\().8h, \src\().8h, \const\().h[\idx0\()]
        mls      \dst\().8h, t2.8h,      consts.h[0]
.endm

.macro mulmod dst, src, const, const_twisted
        sqrdmulh t2.8h,      \src\().8h, \const_twisted\().8h
        mul      \dst\().8h, \src\().8h, \const\().8h
        mls      \dst\().8h, t2.8h,      consts.h[0]
.endm

.macro gs_butterfly a, b, root, idx0, idx1
        sub tmp.8h,   \a\().8h, \b\().8h
        add \a\().8h, \a\().8h, \b\().8h
        mulmodq  \b, tmp, \root, \idx0, \idx1
.endm

.macro gs_butterfly_v a, b, root, root_twisted
        sub tmp.8h,   \a\().8h, \b\().8h
        add \a\().8h, \a\().8h, \b\().8h
        mulmod  \b, tmp, \root, \root_twisted
.endm

.macro mul_ninv dst0, dst1, dst2, dst3, src0, src1, src2, src3
        mulmod \dst0, \src0, ninv, ninv_tw
        mulmod \dst1, \src1, ninv, ninv_tw
        mulmod \dst2, \src2, ninv, ninv_tw
        mulmod \dst3, \src3, ninv, ninv_tw
.endm

.macro barrett_reduce a
        sqdmulh t0.8h,    \a\().8h, consts.h[1]
        srshr   t0.8h,    t0.8h,    #11
        mls     \a\().8h, t0.8h,    consts.h[0]
.endm

.macro load_roots_123
        ldr q_root0, [r12345_ptr], #32
        ldr q_root1, [r12345_ptr, #-16]
.endm

.macro load_next_roots_45
        ldr q_root0, [r12345_ptr], #16
.endm

.macro load_next_roots_67
        ldr q_root0,    [r67_ptr], #(6*16)
        ldr q_root0_tw, [r67_ptr, #(-6*16 + 1*16)]
        ldr q_root1,    [r67_ptr, #(-6*16 + 2*16)]
        ldr q_root1_tw, [r67_ptr, #(-6*16 + 3*16)]
        ldr q_root2,    [r67_ptr, #(-6*16 + 4*16)]
        ldr q_root2_tw, [r67_ptr, #(-6*16 + 5*16)]
.endm

.macro transpose4 data
        trn1 t0.4s, \data\()0.4s, \data\()1.4s
        trn2 t1.4s, \data\()0.4s, \data\()1.4s
        trn1 t2.4s, \data\()2.4s, \data\()3.4s
        trn2 t3.4s, \data\()2.4s, \data\()3.4s

        trn2 \data\()2.2d, t0.2d, t2.2d
        trn2 \data\()3.2d, t1.2d, t3.2d
        trn1 \data\()0.2d, t0.2d, t2.2d
        trn1 \data\()1.2d, t1.2d, t3.2d
.endm

.macro transpose_single data_out, data_in
        trn1 \data_out\()0.4s, \data_in\()0.4s, \data_in\()1.4s
        trn2 \data_out\()1.4s, \data_in\()0.4s, \data_in\()1.4s
        trn1 \data_out\()2.4s, \data_in\()2.4s, \data_in\()3.4s
        trn2 \data_out\()3.4s, \data_in\()2.4s, \data_in\()3.4s
.endm

.macro save_vregs
        sub sp, sp, #(16*4)
        stp  d8,  d9, [sp, #16*0]
        stp d10, d11, [sp, #16*1]
        stp d12, d13, [sp, #16*2]
        stp d14, d15, [sp, #16*3]
.endm

.macro restore_vregs
        ldp  d8,  d9, [sp, #16*0]
        ldp d10, d11, [sp, #16*1]
        ldp d12, d13, [sp, #16*2]
        ldp d14, d15, [sp, #16*3]
        add sp, sp, #(16*4)
.endm

.macro push_stack
        save_vregs
.endm

.macro pop_stack
        restore_vregs
.endm

// For comparability reasons, the output range for the coefficients of this
// invNTT code is supposed to match the implementation from PQClean on commit
// ee71d2c823982bfcf54686f3cf1d666f396dc9aa. After the invNTT, the coefficients
// are NOT canonically reduced. The ordering of the coefficients is canonical,
// also matching PQClean.

        in         .req x0
        r12345_ptr .req x1
        r67_ptr    .req x2

        inp     .req x3
        count   .req x4
        wtmp    .req w5

        data0  .req v8
        data1  .req v9
        data2  .req v10
        data3  .req v11
        data4  .req v12
        data5  .req v13
        data6  .req v14
        data7  .req v15

        q_data0  .req q8
        q_data1  .req q9
        q_data2  .req q10
        q_data3  .req q11
        q_data4  .req q12
        q_data5  .req q13
        q_data6  .req q14
        q_data7  .req q15

        root0    .req v0
        root1    .req v1
        root2    .req v2
        root0_tw .req v4
        root1_tw .req v5
        root2_tw .req v6

        consts     .req v7
        q_consts   .req q7

        q_root0    .req q0
        q_root1    .req q1
        q_root2    .req q2
        q_root0_tw .req q4
        q_root1_tw .req q5
        q_root2_tw .req q6

        tmp .req v24
        t0  .req v25
        t1  .req v26
        t2  .req v27
        t3  .req v28

        ninv             .req v29
        ninv_tw          .req v30

        .text
        .global MLK_ASM_NAMESPACE(intt_asm)
        .balign 4
MLK_ASM_FN_SYMBOL(intt_asm)
        push_stack

        // Setup constants
        mov wtmp, #3329
        mov consts.h[0], wtmp
        mov wtmp, #20159
        mov consts.h[1], wtmp
        mov wtmp, #512
        dup ninv.8h, wtmp
        mov wtmp, #5040
        dup ninv_tw.8h, wtmp

        mov inp, in
        mov count, #8
        .p2align 2
                                               // Instructions:    128
                                               // Expected cycles: 148
                                               // Expected IPC:    0.86
                                               //
                                               // Cycle bound:     148.0
                                               // IPC bound:       0.86
                                               //
                                               // Wall time:     4.66s
                                               // User time:     4.66s
                                               //
                                               // ---------------------------------------------------------------- cycle (expected) ----------------------------------------------------------------->
                                               // 0                        25                       50                       75                       100                      125
                                               // |------------------------|------------------------|------------------------|------------------------|------------------------|----------------------
        ldr q27, [x3, #0]                      // *...................................................................................................................................................
        ldr q19, [x3, #16]                     // ..*.................................................................................................................................................
        ldr q16, [x3, #48]                     // ....*...............................................................................................................................................
        trn2 v8.4S, v27.4S, v19.4S             // ......*.............................................................................................................................................
        trn1 v18.4S, v27.4S, v19.4S            // .......*............................................................................................................................................
        ldr q5, [x3, #32]                      // ........*...........................................................................................................................................
        ldr q14, [x2, #64]                     // ..........*.........................................................................................................................................
        trn2 v12.4S, v5.4S, v16.4S             // ............*.......................................................................................................................................
        trn1 v25.4S, v5.4S, v16.4S             // .............*......................................................................................................................................
        ldr q21, [x2, #16]                     // ..............*.....................................................................................................................................
        trn2 v15.2D, v8.2D, v12.2D             // ................*...................................................................................................................................
        trn1 v3.2D, v8.2D, v12.2D              // .................*..................................................................................................................................
        trn1 v11.2D, v18.2D, v25.2D            // ..................*.................................................................................................................................
        trn2 v2.2D, v18.2D, v25.2D             // ...................*................................................................................................................................
        sub v8.8H, v11.8H, v3.8H               // ....................*...............................................................................................................................
        sub v24.8H, v2.8H, v15.8H              // .....................*..............................................................................................................................
        ldr q28, [x2, #80]                     // ......................*.............................................................................................................................
        mul v22.8H, v24.8H, v14.8H             // ........................*...........................................................................................................................
        ldr q5, [x2, #32]                      // .........................*..........................................................................................................................
        ldr q17, [x2, #48]                     // ...........................*........................................................................................................................
        ldr q6, [x3, #96]                      // .............................*......................................................................................................................
        add v0.8H, v2.8H, v15.8H               // ...............................*....................................................................................................................
        ldr q19, [x3, #64]                     // ................................*...................................................................................................................
        add v2.8H, v11.8H, v3.8H               // ..................................*.................................................................................................................
        ldr q23, [x3, #80]                     // ...................................*................................................................................................................
        ldr q9, [x3, #112]                     // .....................................*..............................................................................................................
        mul v15.8H, v8.8H, v5.8H               // .......................................*............................................................................................................
        sqrdmulh v10.8H, v8.8H, v17.8H         // ........................................*...........................................................................................................
        sqrdmulh v17.8H, v24.8H, v28.8H        // .........................................*..........................................................................................................
        trn2 v14.4S, v6.4S, v9.4S              // ..........................................*.........................................................................................................
        trn2 v20.4S, v19.4S, v23.4S            // ...........................................*........................................................................................................
        trn1 v25.4S, v19.4S, v23.4S            // ............................................*.......................................................................................................
        mls v22.8H, v17.8H, v7.H[0]            // .............................................*......................................................................................................
        mls v15.8H, v10.8H, v7.H[0]            // ..............................................*.....................................................................................................
        trn1 v4.4S, v6.4S, v9.4S               // ...............................................*....................................................................................................
        mul v1.8H, v2.8H, v29.8H               // ................................................*...................................................................................................
        mul v23.8H, v0.8H, v29.8H              // .................................................*..................................................................................................
        sqrdmulh v5.8H, v0.8H, v30.8H          // ..................................................*.................................................................................................
        sqrdmulh v13.8H, v15.8H, v30.8H        // ...................................................*................................................................................................
        sqrdmulh v11.8H, v22.8H, v30.8H        // ....................................................*...............................................................................................
        sqrdmulh v12.8H, v2.8H, v30.8H         // .....................................................*..............................................................................................
        mul v19.8H, v22.8H, v29.8H             // ......................................................*.............................................................................................
        mul v0.8H, v15.8H, v29.8H              // .......................................................*............................................................................................
        trn1 v15.2D, v25.2D, v4.2D             // ........................................................*...........................................................................................
        trn2 v22.2D, v25.2D, v4.2D             // .........................................................*..........................................................................................
        trn2 v24.2D, v20.2D, v14.2D            // ..........................................................*.........................................................................................
        mls v0.8H, v13.8H, v7.H[0]             // ...........................................................*........................................................................................
        mls v23.8H, v5.8H, v7.H[0]             // ............................................................*.......................................................................................
        sub v10.8H, v22.8H, v24.8H             // .............................................................*......................................................................................
        trn1 v31.2D, v20.2D, v14.2D            // ..............................................................*.....................................................................................
        mls v1.8H, v12.8H, v7.H[0]             // ...............................................................*....................................................................................
        mls v19.8H, v11.8H, v7.H[0]            // ................................................................*...................................................................................
        ldr q13, [x2, #144]                    // .................................................................*..................................................................................
        ldr q14, [x2, #160]                    // ...................................................................*................................................................................
        ldr q5, [x2, #128]                     // .....................................................................*..............................................................................
        ldr q2, [x2, #176]                     // .......................................................................*............................................................................
        ldr q25, [x2], #(6*16)                 // .........................................................................*..........................................................................
        sub v9.8H, v15.8H, v31.8H              // ...........................................................................*........................................................................
        add v15.8H, v15.8H, v31.8H             // ............................................................................*.......................................................................
        sub v28.8H, v1.8H, v23.8H              // .............................................................................*......................................................................
        sqrdmulh v26.8H, v9.8H, v13.8H         // ..............................................................................*.....................................................................
        mul v11.8H, v9.8H, v5.8H               // ...............................................................................*....................................................................
        mul v14.8H, v10.8H, v14.8H             // ................................................................................*...................................................................
        sub v4.8H, v0.8H, v19.8H               // .................................................................................*..................................................................
        sqrdmulh v6.8H, v10.8H, v2.8H          // ..................................................................................*.................................................................
        mls v11.8H, v26.8H, v7.H[0]            // ...................................................................................*................................................................
        mul v9.8H, v28.8H, v25.8H              // ....................................................................................*...............................................................
        sqrdmulh v18.8H, v4.8H, v21.8H         // .....................................................................................*..............................................................
        sqrdmulh v16.8H, v28.8H, v21.8H        // ......................................................................................*.............................................................
        mul v20.8H, v4.8H, v25.8H              // .......................................................................................*............................................................
        mls v14.8H, v6.8H, v7.H[0]             // ........................................................................................*...........................................................
        add v21.8H, v22.8H, v24.8H             // .........................................................................................*..........................................................
        mul v17.8H, v15.8H, v29.8H             // ..........................................................................................*.........................................................
        mls v20.8H, v18.8H, v7.H[0]            // ...........................................................................................*........................................................
        mls v9.8H, v16.8H, v7.H[0]             // ............................................................................................*.......................................................
        mul v24.8H, v21.8H, v29.8H             // .............................................................................................*......................................................
        mul v16.8H, v11.8H, v29.8H             // ..............................................................................................*.....................................................
        mul v22.8H, v14.8H, v29.8H             // ...............................................................................................*....................................................
        sqrdmulh v13.8H, v21.8H, v30.8H        // ................................................................................................*...................................................
        add v10.8H, v0.8H, v19.8H              // .................................................................................................*..................................................
        add v23.8H, v1.8H, v23.8H              // ..................................................................................................*.................................................
        sqrdmulh v15.8H, v15.8H, v30.8H        // ...................................................................................................*................................................
        sqrdmulh v26.8H, v14.8H, v30.8H        // ....................................................................................................*...............................................
        sqrdmulh v11.8H, v11.8H, v30.8H        // .....................................................................................................*..............................................
        mls v24.8H, v13.8H, v7.H[0]            // ......................................................................................................*.............................................
        mls v17.8H, v15.8H, v7.H[0]            // .......................................................................................................*............................................
        mls v22.8H, v26.8H, v7.H[0]            // ........................................................................................................*...........................................
        ldr q28, [x2], #(6*16)                 // .........................................................................................................*..........................................
        trn1 v6.4S, v9.4S, v20.4S              // ...........................................................................................................*........................................
        trn2 v21.4S, v9.4S, v20.4S             // ............................................................................................................*.......................................
        trn2 v1.4S, v23.4S, v10.4S             // .............................................................................................................*......................................
        trn1 v25.4S, v23.4S, v10.4S            // ..............................................................................................................*.....................................
        ldr q10, [x2, #-80]                    // ...............................................................................................................*....................................
        sub v4.8H, v17.8H, v24.8H              // .................................................................................................................*..................................
        mls v16.8H, v11.8H, v7.H[0]            // ..................................................................................................................*.................................
        add v14.8H, v17.8H, v24.8H             // ...................................................................................................................*................................
        sqrdmulh v23.8H, v4.8H, v10.8H         // ....................................................................................................................*...............................
        trn1 v0.2D, v25.2D, v6.2D              // .....................................................................................................................*..............................
        trn2 v2.2D, v1.2D, v21.2D              // ......................................................................................................................*.............................
        trn1 v11.2D, v1.2D, v21.2D             // .......................................................................................................................*............................
        trn2 v15.2D, v25.2D, v6.2D             // ........................................................................................................................*...........................
        add v6.8H, v0.8H, v11.8H               // .........................................................................................................................*..........................
        add v26.8H, v15.8H, v2.8H              // ..........................................................................................................................*.........................
        sub v18.8H, v16.8H, v22.8H             // ...........................................................................................................................*........................
        mul v4.8H, v4.8H, v28.8H               // ............................................................................................................................*.......................
        sub v19.8H, v6.8H, v26.8H              // .............................................................................................................................*......................
        mul v12.8H, v18.8H, v28.8H             // ..............................................................................................................................*.....................
        add v8.8H, v6.8H, v26.8H               // ...............................................................................................................................*....................
        add v28.8H, v16.8H, v22.8H             // ................................................................................................................................*...................
        sqrdmulh v1.8H, v18.8H, v10.8H         // .................................................................................................................................*..................
        mls v4.8H, v23.8H, v7.H[0]             // ..................................................................................................................................*.................
        sqdmulh v21.8H, v8.8H, v7.H[1]         // ...................................................................................................................................*................
        trn1 v5.4S, v14.4S, v28.4S             // ....................................................................................................................................*...............
        mls v12.8H, v1.8H, v7.H[0]             // .....................................................................................................................................*..............
        sub v15.8H, v15.8H, v2.8H              // ......................................................................................................................................*.............
        srshr v18.8H, v21.8H, #11              // .......................................................................................................................................*............
        sub v20.8H, v0.8H, v11.8H              // ........................................................................................................................................*...........
        trn2 v26.4S, v4.4S, v12.4S             // .........................................................................................................................................*..........
        trn2 v14.4S, v14.4S, v28.4S            // ..........................................................................................................................................*.........
        mls v8.8H, v18.8H, v7.H[0]             // ...........................................................................................................................................*........
        trn1 v10.4S, v4.4S, v12.4S             // ............................................................................................................................................*.......
        trn1 v24.2D, v14.2D, v26.2D            // .............................................................................................................................................*......
        trn2 v1.2D, v14.2D, v26.2D             // ..............................................................................................................................................*.....
        trn1 v3.2D, v5.2D, v10.2D              // ...............................................................................................................................................*....
        str q8, [x3], #(64)                    // ................................................................................................................................................*...
        trn2 v23.2D, v5.2D, v10.2D             // .................................................................................................................................................*..
        add v12.8H, v3.8H, v24.8H              // ..................................................................................................................................................*.
        add v9.8H, v23.8H, v1.8H               // ...................................................................................................................................................*

                                                // ---------------------------------------------------------------- cycle (expected) ----------------------------------------------------------------->
                                                // 0                        25                       50                       75                       100                      125
                                                // |------------------------|------------------------|------------------------|------------------------|------------------------|----------------------
        // ldr q26, [x3, #16]                   // ..*.................................................................................................................................................
        // ldr q2, [x3, #0]                     // *...................................................................................................................................................
        // trn1 v14.4S, v2.4S, v26.4S           // .......*............................................................................................................................................
        // trn2 v11.4S, v2.4S, v26.4S           // ......*.............................................................................................................................................
        // ldr q23, [x2, #80]                   // ......................*.............................................................................................................................
        // ldr q22, [x3, #32]                   // ........*...........................................................................................................................................
        // ldr q26, [x2, #64]                   // ..........*.........................................................................................................................................
        // ldr q17, [x3, #48]                   // ....*...............................................................................................................................................
        // ldr q0, [x2, #48]                    // ...........................*........................................................................................................................
        // trn1 v6.4S, v22.4S, v17.4S           // .............*......................................................................................................................................
        // trn2 v13.4S, v22.4S, v17.4S          // ............*.......................................................................................................................................
        // trn2 v16.2D, v14.2D, v6.2D           // ...................*................................................................................................................................
        // trn1 v2.2D, v14.2D, v6.2D            // ..................*.................................................................................................................................
        // trn2 v31.2D, v11.2D, v13.2D          // ................*...................................................................................................................................
        // trn1 v11.2D, v11.2D, v13.2D          // .................*..................................................................................................................................
        // sub v14.8H, v16.8H, v31.8H           // .....................*..............................................................................................................................
        // add v28.8H, v2.8H, v11.8H            // ..................................*.................................................................................................................
        // sub v25.8H, v2.8H, v11.8H            // ....................*...............................................................................................................................
        // sqrdmulh v19.8H, v14.8H, v23.8H      // .........................................*..........................................................................................................
        // ldr q8, [x2, #32]                    // .........................*..........................................................................................................................
        // mul v23.8H, v14.8H, v26.8H           // ........................*...........................................................................................................................
        // add v17.8H, v16.8H, v31.8H           // ...............................*....................................................................................................................
        // sqrdmulh v27.8H, v25.8H, v0.8H       // ........................................*...........................................................................................................
        // mul v22.8H, v25.8H, v8.8H            // .......................................*............................................................................................................
        // mul v26.8H, v17.8H, v29.8H           // .................................................*..................................................................................................
        // mls v23.8H, v19.8H, v7.H[0]          // .............................................*......................................................................................................
        // mls v22.8H, v27.8H, v7.H[0]          // ..............................................*.....................................................................................................
        // ldr q13, [x2, #16]                   // ..............*.....................................................................................................................................
        // sqrdmulh v20.8H, v23.8H, v30.8H      // ....................................................*...............................................................................................
        // sqrdmulh v1.8H, v28.8H, v30.8H       // .....................................................*..............................................................................................
        // mul v0.8H, v28.8H, v29.8H            // ................................................*...................................................................................................
        // mul v8.8H, v22.8H, v29.8H            // .......................................................*............................................................................................
        // ldr q14, [x2], #(6*16)               // .........................................................................*..........................................................................
        // mul v31.8H, v23.8H, v29.8H           // ......................................................*.............................................................................................
        // sqrdmulh v28.8H, v22.8H, v30.8H      // ...................................................*................................................................................................
        // sqrdmulh v22.8H, v17.8H, v30.8H      // ..................................................*.................................................................................................
        // mls v31.8H, v20.8H, v7.H[0]          // ................................................................*...................................................................................
        // mls v0.8H, v1.8H, v7.H[0]            // ...............................................................*....................................................................................
        // mls v8.8H, v28.8H, v7.H[0]           // ...........................................................*........................................................................................
        // mls v26.8H, v22.8H, v7.H[0]          // ............................................................*.......................................................................................
        // add v17.8H, v8.8H, v31.8H            // .................................................................................................*..................................................
        // sub v2.8H, v8.8H, v31.8H             // .................................................................................*..................................................................
        // mul v8.8H, v2.8H, v14.8H             // .......................................................................................*............................................................
        // sqrdmulh v21.8H, v2.8H, v13.8H       // .....................................................................................*..............................................................
        // sub v28.8H, v0.8H, v26.8H            // .............................................................................*......................................................................
        // add v10.8H, v0.8H, v26.8H            // ..................................................................................................*.................................................
        // mul v18.8H, v28.8H, v14.8H           // ....................................................................................*...............................................................
        // sqrdmulh v11.8H, v28.8H, v13.8H      // ......................................................................................*.............................................................
        // mls v8.8H, v21.8H, v7.H[0]           // ...........................................................................................*........................................................
        // trn2 v27.4S, v10.4S, v17.4S          // .............................................................................................................*......................................
        // mls v18.8H, v11.8H, v7.H[0]          // ............................................................................................*.......................................................
        // trn1 v31.4S, v10.4S, v17.4S          // ..............................................................................................................*.....................................
        // trn1 v21.4S, v18.4S, v8.4S           // ...........................................................................................................*........................................
        // trn2 v4.4S, v18.4S, v8.4S            // ............................................................................................................*.......................................
        // trn2 v23.2D, v31.2D, v21.2D          // ........................................................................................................................*...........................
        // trn1 v3.2D, v31.2D, v21.2D           // .....................................................................................................................*..............................
        // trn2 v1.2D, v27.2D, v4.2D            // ......................................................................................................................*.............................
        // trn1 v24.2D, v27.2D, v4.2D           // .......................................................................................................................*............................
        // add v9.8H, v23.8H, v1.8H             // ..........................................................................................................................*.........................
        // add v12.8H, v3.8H, v24.8H            // .........................................................................................................................*..........................
        // ldr q26, [x3, #80]                   // ...................................*................................................................................................................
        // ldr q2, [x3, #64]                    // ................................*...................................................................................................................
        // trn1 v14.4S, v2.4S, v26.4S           // ............................................*.......................................................................................................
        // trn2 v11.4S, v2.4S, v26.4S           // ...........................................*........................................................................................................
        // sub v15.8H, v23.8H, v1.8H            // ......................................................................................................................................*.............
        // ldr q23, [x2, #80]                   // .......................................................................*............................................................................
        // ldr q22, [x3, #96]                   // .............................*......................................................................................................................
        // ldr q26, [x2, #64]                   // ...................................................................*................................................................................
        // ldr q17, [x3, #112]                  // .....................................*..............................................................................................................
        // ldr q0, [x2, #48]                    // .................................................................*..................................................................................
        // trn1 v6.4S, v22.4S, v17.4S           // ...............................................*....................................................................................................
        // trn2 v13.4S, v22.4S, v17.4S          // ..........................................*.........................................................................................................
        // trn2 v16.2D, v14.2D, v6.2D           // .........................................................*..........................................................................................
        // trn1 v2.2D, v14.2D, v6.2D            // ........................................................*...........................................................................................
        // trn2 v31.2D, v11.2D, v13.2D          // ..........................................................*.........................................................................................
        // trn1 v11.2D, v11.2D, v13.2D          // ..............................................................*.....................................................................................
        // sub v14.8H, v16.8H, v31.8H           // .............................................................*......................................................................................
        // add v28.8H, v2.8H, v11.8H            // ............................................................................*.......................................................................
        // sub v25.8H, v2.8H, v11.8H            // ...........................................................................*........................................................................
        // sqrdmulh v19.8H, v14.8H, v23.8H      // ..................................................................................*.................................................................
        // ldr q8, [x2, #32]                    // .....................................................................*..............................................................................
        // mul v23.8H, v14.8H, v26.8H           // ................................................................................*...................................................................
        // add v17.8H, v16.8H, v31.8H           // .........................................................................................*..........................................................
        // sqrdmulh v27.8H, v25.8H, v0.8H       // ..............................................................................*.....................................................................
        // mul v22.8H, v25.8H, v8.8H            // ...............................................................................*....................................................................
        // mul v26.8H, v17.8H, v29.8H           // .............................................................................................*......................................................
        // mls v23.8H, v19.8H, v7.H[0]          // ........................................................................................*...........................................................
        // mls v22.8H, v27.8H, v7.H[0]          // ...................................................................................*................................................................
        // ldr q13, [x2, #16]                   // ...............................................................................................................*....................................
        // sqrdmulh v20.8H, v23.8H, v30.8H      // ....................................................................................................*...............................................
        // sqrdmulh v1.8H, v28.8H, v30.8H       // ...................................................................................................*................................................
        // mul v0.8H, v28.8H, v29.8H            // ..........................................................................................*.........................................................
        // mul v8.8H, v22.8H, v29.8H            // ..............................................................................................*.....................................................
        // ldr q14, [x2], #(6*16)               // .........................................................................................................*..........................................
        // mul v31.8H, v23.8H, v29.8H           // ...............................................................................................*....................................................
        // sqrdmulh v28.8H, v22.8H, v30.8H      // .....................................................................................................*..............................................
        // sqrdmulh v22.8H, v17.8H, v30.8H      // ................................................................................................*...................................................
        // sub v19.8H, v12.8H, v9.8H            // .............................................................................................................................*......................
        // mls v31.8H, v20.8H, v7.H[0]          // ........................................................................................................*...........................................
        // sub v20.8H, v3.8H, v24.8H            // ........................................................................................................................................*...........
        // mls v0.8H, v1.8H, v7.H[0]            // .......................................................................................................*............................................
        // mls v8.8H, v28.8H, v7.H[0]           // ..................................................................................................................*.................................
        // mls v26.8H, v22.8H, v7.H[0]          // ......................................................................................................*.............................................
        // add v17.8H, v8.8H, v31.8H            // ................................................................................................................................*...................
        // add v23.8H, v12.8H, v9.8H            // ...............................................................................................................................*....................
        // sub v2.8H, v8.8H, v31.8H             // ...........................................................................................................................*........................
        // sqdmulh v28.8H, v23.8H, v7.H[1]      // ...................................................................................................................................*................
        // mul v8.8H, v2.8H, v14.8H             // ..............................................................................................................................*.....................
        // sqrdmulh v21.8H, v2.8H, v13.8H       // .................................................................................................................................*..................
        // srshr v22.8H, v28.8H, #11            // .......................................................................................................................................*............
        // sub v28.8H, v0.8H, v26.8H            // .................................................................................................................*..................................
        // add v10.8H, v0.8H, v26.8H            // ...................................................................................................................*................................
        // mul v18.8H, v28.8H, v14.8H           // ............................................................................................................................*.......................
        // sqrdmulh v11.8H, v28.8H, v13.8H      // ....................................................................................................................*...............................
        // mls v23.8H, v22.8H, v7.H[0]          // ...........................................................................................................................................*........
        // mls v8.8H, v21.8H, v7.H[0]           // .....................................................................................................................................*..............
        // trn2 v27.4S, v10.4S, v17.4S          // ..........................................................................................................................................*.........
        // mls v18.8H, v11.8H, v7.H[0]          // ..................................................................................................................................*.................
        // trn1 v31.4S, v10.4S, v17.4S          // ....................................................................................................................................*...............
        // str q23, [x3], #(64)                 // ................................................................................................................................................*...
        // trn1 v21.4S, v18.4S, v8.4S           // ............................................................................................................................................*.......
        // trn2 v4.4S, v18.4S, v8.4S            // .........................................................................................................................................*..........
        // trn2 v23.2D, v31.2D, v21.2D          // .................................................................................................................................................*..
        // trn1 v3.2D, v31.2D, v21.2D           // ...............................................................................................................................................*....
        // trn2 v1.2D, v27.2D, v4.2D            // ..............................................................................................................................................*.....
        // trn1 v24.2D, v27.2D, v4.2D           // .............................................................................................................................................*......
        // add v9.8H, v23.8H, v1.8H             // ...................................................................................................................................................*
        // add v12.8H, v3.8H, v24.8H            // ..................................................................................................................................................*.

        sub count, count, #2
intt_layer4567_start:
                                                 // Instructions:    86
                                                 // Expected cycles: 97
                                                 // Expected IPC:    0.89
                                                 //
                                                 // Cycle bound:     97.0
                                                 // IPC bound:       0.89
                                                 //
                                                 // Wall time:     19.92s
                                                 // User time:     19.92s
                                                 //
                                                 // --------------------------------------- cycle (expected) --------------------------------------->
                                                 // 0                        25                       50                       75
                                                 // |------------------------|------------------------|------------------------|---------------------
        ldr q10, [x1], #16                       // l................................................................................................
        ldr q26, [x3, #80]                       // ..e..............................................................................................
        sqrdmulh v22.8H, v19.8H, v10.H[1]        // ....l............................................................................................
        mul v18.8H, v19.8H, v10.H[0]             // .....l...........................................................................................
        ldr q2, [x3, #64]                        // ......e..........................................................................................
        mul v5.8H, v15.8H, v10.H[4]              // ........l........................................................................................
        mls v18.8H, v22.8H, v7.H[0]              // .........l.......................................................................................
        trn1 v14.4S, v2.4S, v26.4S               // ..........e......................................................................................
        trn2 v11.4S, v2.4S, v26.4S               // ...........e.....................................................................................
        sqrdmulh v21.8H, v15.8H, v10.H[5]        // ............l....................................................................................
        sub v15.8H, v23.8H, v1.8H                // .............*...................................................................................
        ldr q23, [x2, #80]                       // ..............e..................................................................................
        ldr q22, [x3, #96]                       // ................e................................................................................
        ldr q26, [x2, #64]                       // ..................e..............................................................................
        ldr q17, [x3, #112]                      // ....................e............................................................................
        ldr q0, [x2, #48]                        // ......................e..........................................................................
        trn1 v6.4S, v22.4S, v17.4S               // ........................e........................................................................
        trn2 v13.4S, v22.4S, v17.4S              // .........................e.......................................................................
        mls v5.8H, v21.8H, v7.H[0]               // ..........................l......................................................................
        trn2 v16.2D, v14.2D, v6.2D               // ...........................e.....................................................................
        trn1 v2.2D, v14.2D, v6.2D                // ............................e....................................................................
        trn2 v31.2D, v11.2D, v13.2D              // .............................e...................................................................
        trn1 v11.2D, v11.2D, v13.2D              // ..............................e..................................................................
        sub v14.8H, v16.8H, v31.8H               // ...............................e.................................................................
        add v28.8H, v2.8H, v11.8H                // ................................e................................................................
        sub v25.8H, v2.8H, v11.8H                // .................................e...............................................................
        sqrdmulh v19.8H, v14.8H, v23.8H          // ..................................e..............................................................
        ldr q8, [x2, #32]                        // ...................................e.............................................................
        mul v23.8H, v14.8H, v26.8H               // .....................................e...........................................................
        add v17.8H, v16.8H, v31.8H               // ......................................e..........................................................
        sqrdmulh v27.8H, v25.8H, v0.8H           // .......................................e.........................................................
        sqrdmulh v16.8H, v20.8H, v10.H[3]        // ........................................l........................................................
        mul v22.8H, v25.8H, v8.8H                // .........................................e.......................................................
        mul v26.8H, v17.8H, v29.8H               // ..........................................e......................................................
        mls v23.8H, v19.8H, v7.H[0]              // ...........................................e.....................................................
        mul v4.8H, v20.8H, v10.H[2]              // ............................................l....................................................
        mls v22.8H, v27.8H, v7.H[0]              // .............................................e...................................................
        ldr q13, [x2, #16]                       // ..............................................e..................................................
        sqrdmulh v20.8H, v23.8H, v30.8H          // ................................................e................................................
        sqrdmulh v1.8H, v28.8H, v30.8H           // .................................................e...............................................
        mul v0.8H, v28.8H, v29.8H                // ..................................................e..............................................
        mul v8.8H, v22.8H, v29.8H                // ...................................................e.............................................
        ldr q14, [x2], #(6*16)                   // ....................................................e............................................
        mul v31.8H, v23.8H, v29.8H               // ......................................................e..........................................
        sqrdmulh v28.8H, v22.8H, v30.8H          // .......................................................e.........................................
        str q18, [x3, #-32]                      // ........................................................l........................................
        sqrdmulh v22.8H, v17.8H, v30.8H          // .........................................................e.......................................
        mls v4.8H, v16.8H, v7.H[0]               // ..........................................................l......................................
        sub v19.8H, v12.8H, v9.8H                // ...........................................................*.....................................
        mls v31.8H, v20.8H, v7.H[0]              // ............................................................e....................................
        sub v20.8H, v3.8H, v24.8H                // .............................................................*...................................
        mls v0.8H, v1.8H, v7.H[0]                // ..............................................................e..................................
        mls v8.8H, v28.8H, v7.H[0]               // ...............................................................e.................................
        sub v18.8H, v4.8H, v5.8H                 // ................................................................l................................
        mls v26.8H, v22.8H, v7.H[0]              // .................................................................e...............................
        add v1.8H, v4.8H, v5.8H                  // ..................................................................l..............................
        add v17.8H, v8.8H, v31.8H                // ...................................................................e.............................
        add v23.8H, v12.8H, v9.8H                // ....................................................................*............................
        sub v2.8H, v8.8H, v31.8H                 // .....................................................................e...........................
        sqrdmulh v31.8H, v18.8H, v10.H[1]        // ......................................................................l..........................
        sqdmulh v28.8H, v23.8H, v7.H[1]          // .......................................................................*.........................
        mul v8.8H, v2.8H, v14.8H                 // ........................................................................e........................
        sqrdmulh v21.8H, v2.8H, v13.8H           // .........................................................................e.......................
        mul v2.8H, v18.8H, v10.H[0]              // ..........................................................................l......................
        srshr v22.8H, v28.8H, #11                // ...........................................................................*.....................
        sub v28.8H, v0.8H, v26.8H                // ............................................................................e....................
        add v10.8H, v0.8H, v26.8H                // .............................................................................e...................
        str q1, [x3, #-48]                       // ..............................................................................l..................
        mul v18.8H, v28.8H, v14.8H               // ...............................................................................e.................
        sqrdmulh v11.8H, v28.8H, v13.8H          // ................................................................................e................
        mls v23.8H, v22.8H, v7.H[0]              // .................................................................................*...............
        mls v8.8H, v21.8H, v7.H[0]               // ..................................................................................e..............
        trn2 v27.4S, v10.4S, v17.4S              // ...................................................................................e.............
        mls v18.8H, v11.8H, v7.H[0]              // ....................................................................................e............
        mls v2.8H, v31.8H, v7.H[0]               // .....................................................................................l...........
        trn1 v31.4S, v10.4S, v17.4S              // ......................................................................................e..........
        str q23, [x3], #(64)                     // .......................................................................................*.........
        trn1 v21.4S, v18.4S, v8.4S               // ........................................................................................e........
        str q2, [x3, #-80]                       // .........................................................................................l.......
        trn2 v4.4S, v18.4S, v8.4S                // ..........................................................................................e......
        trn2 v23.2D, v31.2D, v21.2D              // ...........................................................................................e.....
        trn1 v3.2D, v31.2D, v21.2D               // ............................................................................................e....
        trn2 v1.2D, v27.2D, v4.2D                // .............................................................................................e...
        trn1 v24.2D, v27.2D, v4.2D               // ..............................................................................................e..
        add v9.8H, v23.8H, v1.8H                 // ...............................................................................................e.
        add v12.8H, v3.8H, v24.8H                // ................................................................................................e

                                                      // ----------------------------------------------------------------------------------------------------------------------------------- cycle (expected) ------------------------------------------------------------------------------------------------------------------------------------>
                                                      // 0                        25                       50                       75                       100                      125                      150                      175                      200                      225                      250                      275
                                                      // |------------------------|------------------------|------------------------|------------------------|------------------------|------------------------|------------------------|------------------------|------------------------|------------------------|------------------------|------
        // ldr q8, [x3, #(16*0)]                      // ....e..........................................................................................'.....~..........................................................................................'.....~...................................................................................
        // ldr q9, [x3, #(16*1)]                      // e..............................................................................................'.~..............................................................................................'.~.......................................................................................
        // ldr q10, [x3, #(16*2)]                     // ..............e................................................................................'...............~................................................................................'...............~.........................................................................
        // ldr q11, [x3, #(16*3)]                     // ..................e............................................................................'...................~............................................................................'...................~.....................................................................
        // trn1 v25.4s, v8.4s, v9.4s                  // ........e......................................................................................'.........~......................................................................................'.........~...............................................................................
        // trn2 v26.4s, v8.4s, v9.4s                  // .........e.....................................................................................'..........~.....................................................................................'..........~..............................................................................
        // trn1 v27.4s, v10.4s, v11.4s                // ......................e........................................................................'.......................~........................................................................'.......................~.................................................................
        // trn2 v28.4s, v10.4s, v11.4s                // .......................e.......................................................................'........................~.......................................................................'........................~................................................................
        // trn2 v10.2d, v25.2d, v27.2d                // .........................e.....................................................................'..........................~.....................................................................'..........................~..............................................................
        // trn2 v11.2d, v26.2d, v28.2d                // ...........................e...................................................................'............................~...................................................................'............................~............................................................
        // trn1 v8.2d, v25.2d, v27.2d                 // ..........................e....................................................................'...........................~....................................................................'...........................~.............................................................
        // trn1 v9.2d, v26.2d, v28.2d                 // ............................e..................................................................'.............................~..................................................................'.............................~...........................................................
        // ldr q0,    [x2], #(6*16)                   // ..................................................e............................................'...................................................~............................................'...................................................~.....................................
        // ldr q4, [x2, #(-6*16 + 1*16)]              // ............................................e..................................................'.............................................~..................................................'.............................................~...........................................
        // ldr q1,    [x2, #(-6*16 + 2*16)]           // .................................e.............................................................'..................................~.............................................................'..................................~......................................................
        // ldr q5, [x2, #(-6*16 + 3*16)]              // ....................e..........................................................................'.....................~..........................................................................'.....................~...................................................................
        // ldr q2,    [x2, #(-6*16 + 4*16)]           // ................e..............................................................................'.................~..............................................................................'.................~.......................................................................
        // ldr q6, [x2, #(-6*16 + 5*16)]              // ............e..................................................................................'.............~..................................................................................'.............~...........................................................................
        // sub v24.8h,   v8.8h, v9.8h                 // ...............................e...............................................................'................................~...............................................................'................................~........................................................
        // add v8.8h, v8.8h, v9.8h                    // ..............................e................................................................'...............................~................................................................'...............................~.........................................................
        // sqrdmulh v27.8h,      v24.8h, v5.8h        // .....................................e.........................................................'......................................~.........................................................'......................................~..................................................
        // mul      v9.8h, v24.8h, v1.8h              // .......................................e.......................................................'........................................~.......................................................'........................................~................................................
        // mls      v9.8h, v27.8h,      v7.h[0]       // ...........................................e...................................................'............................................~...................................................'............................................~............................................
        // sub v24.8h,   v10.8h, v11.8h               // .............................e.................................................................'..............................~.................................................................'..............................~..........................................................
        // add v10.8h, v10.8h, v11.8h                 // ....................................e..........................................................'.....................................~..........................................................'.....................................~...................................................
        // sqrdmulh v27.8h,      v24.8h, v6.8h        // ................................e..............................................................'.................................~..............................................................'.................................~.......................................................
        // mul      v11.8h, v24.8h, v2.8h             // ...................................e...........................................................'....................................~...........................................................'....................................~....................................................
        // mls      v11.8h, v27.8h,      v7.h[0]      // .........................................e.....................................................'..........................................~.....................................................'..........................................~..............................................
        // sqrdmulh v27.8h,      v8.8h, v30.8h        // ...............................................e...............................................'................................................~...............................................'................................................~........................................
        // mul      v8.8h, v8.8h, v29.8h              // ................................................e..............................................'.................................................~..............................................'.................................................~.......................................
        // mls      v8.8h, v27.8h,      v7.h[0]       // ............................................................e..................................'.............................................................~..................................'.............................................................~...........................
        // sqrdmulh v27.8h,      v9.8h, v30.8h        // .....................................................e.........................................'......................................................~.........................................'......................................................~..................................
        // mul      v9.8h, v9.8h, v29.8h              // .................................................e.............................................'..................................................~.............................................'..................................................~......................................
        // mls      v9.8h, v27.8h,      v7.h[0]       // .............................................................e.................................'..............................................................~.................................'..............................................................~..........................
        // sqrdmulh v27.8h,      v10.8h, v30.8h       // .......................................................e.......................................'........................................................~.......................................'........................................................~................................
        // mul      v10.8h, v10.8h, v29.8h            // ........................................e......................................................'.........................................~......................................................'.........................................~...............................................
        // mls      v10.8h, v27.8h,      v7.h[0]      // ...............................................................e...............................'................................................................~...............................'................................................................~........................
        // sqrdmulh v27.8h,      v11.8h, v30.8h       // ..............................................e................................................'...............................................~................................................'...............................................~.........................................
        // mul      v11.8h, v11.8h, v29.8h            // ....................................................e..........................................'.....................................................~..........................................'.....................................................~...................................
        // mls      v11.8h, v27.8h,      v7.h[0]      // ..........................................................e....................................'...........................................................~....................................'...........................................................~.............................
        // sub v24.8h,   v8.8h, v10.8h                // ..........................................................................e....................'...........................................................................~....................'...........................................................................~.............
        // add v8.8h, v8.8h, v10.8h                   // ...........................................................................e...................'............................................................................~...................'............................................................................~............
        // sqrdmulh v27.8h,      v24.8h, v4.8h        // ..............................................................................e................'...............................................................................~................'...............................................................................~.........
        // mul      v10.8h, v24.8h, v0.8h             // .............................................................................e.................'..............................................................................~.................'..............................................................................~..........
        // mls      v10.8h, v27.8h,      v7.h[0]      // ..................................................................................e............'...................................................................................~............'...................................................................................~.....
        // sub v24.8h,   v9.8h, v11.8h                // ...................................................................e...........................'....................................................................~...........................'....................................................................~....................
        // add v9.8h, v9.8h, v11.8h                   // .................................................................e.............................'..................................................................~.............................'..................................................................~......................
        // sqrdmulh v27.8h,      v24.8h, v4.8h        // .......................................................................e.......................'........................................................................~.......................'........................................................................~................
        // mul      v11.8h, v24.8h, v0.8h             // ......................................................................e........................'.......................................................................~........................'.......................................................................~.................
        // mls      v11.8h, v27.8h,      v7.h[0]      // ................................................................................e..............'.................................................................................~..............'.................................................................................~.......
        // trn1 v25.4s, v8.4s, v9.4s                  // ....................................................................................e..........'.....................................................................................~..........'.....................................................................................~...
        // trn2 v26.4s, v8.4s, v9.4s                  // .................................................................................e.............'..................................................................................~.............'..................................................................................~......
        // trn1 v27.4s, v10.4s, v11.4s                // ......................................................................................e........'.......................................................................................~........'.......................................................................................~.
        // trn2 v28.4s, v10.4s, v11.4s                // ........................................................................................e......'.........................................................................................~......'.........................................................................................
        // trn2 v10.2d, v25.2d, v27.2d                // .........................................................................................e.....'..........................................................................................~.....'.........................................................................................
        // trn2 v11.2d, v26.2d, v28.2d                // ...........................................................................................e...'............................................................................................~...'.........................................................................................
        // trn1 v8.2d, v25.2d, v27.2d                 // ..........................................................................................e....'...........................................................................................~....'.........................................................................................
        // trn1 v9.2d, v26.2d, v28.2d                 // ............................................................................................e..'.............................................................................................~..'.........................................................................................
        // ldr q0, [x1], #16                          // ...............................................................................................~................................................................................................l.........................................................................................
        // sub v24.8h,   v8.8h, v9.8h                 // ...........................................................~...................................'............................................................*...................................'............................................................~............................
        // add v8.8h, v8.8h, v9.8h                    // ..............................................................................................e'...............................................................................................~'.........................................................................................
        // sqrdmulh v27.8h,      v24.8h, v0.h[3]      // ......................................~........................................................'.......................................~........................................................'.......................................l.................................................
        // mul      v9.8h, v24.8h, v0.h[2]            // ..........................................~....................................................'...........................................~....................................................'...........................................l.............................................
        // mls      v9.8h, v27.8h,      v7.h[0]       // ........................................................~......................................'.........................................................~......................................'.........................................................l...............................
        // sub v24.8h,   v10.8h, v11.8h               // ...........~...................................................................................'............*...................................................................................'............~............................................................................
        // add v10.8h, v10.8h, v11.8h                 // .............................................................................................e.'..............................................................................................~.'.........................................................................................
        // sqrdmulh v27.8h,      v24.8h, v0.h[5]      // ..........~....................................................................................'...........~....................................................................................'...........l.............................................................................
        // mul      v11.8h, v24.8h, v0.h[4]           // ......~........................................................................................'.......~........................................................................................'.......l.................................................................................
        // mls      v11.8h, v27.8h,      v7.h[0]      // ........................~......................................................................'.........................~......................................................................'.........................l...............................................................
        // sub v24.8h,   v8.8h, v10.8h                // .........................................................~.....................................'..........................................................*.....................................'..........................................................~..............................
        // add v8.8h, v8.8h, v10.8h                   // ..................................................................~............................'...................................................................*............................'...................................................................~.....................
        // sqrdmulh v27.8h,      v24.8h, v0.h[1]      // ..~............................................................................................'...~............................................................................................'...l.....................................................................................
        // mul      v10.8h, v24.8h, v0.h[0]           // ...~...........................................................................................'....~...........................................................................................'....l....................................................................................
        // mls      v10.8h, v27.8h,      v7.h[0]      // .......~.......................................................................................'........~.......................................................................................'........l................................................................................
        // sub v24.8h,   v9.8h, v11.8h                // ..............................................................~................................'...............................................................~................................'...............................................................l.........................
        // add v9.8h, v9.8h, v11.8h                   // ................................................................~..............................'.................................................................~..............................'.................................................................l.......................
        // sqrdmulh v27.8h,      v24.8h, v0.h[1]      // ....................................................................~..........................'.....................................................................~..........................'.....................................................................l...................
        // mul      v11.8h, v24.8h, v0.h[0]           // ........................................................................~......................'.........................................................................~......................'.........................................................................l...............
        // mls      v11.8h, v27.8h,      v7.h[0]      // ...................................................................................~...........'....................................................................................~...........'....................................................................................l....
        // sqdmulh v25.8h,    v8.8h, v7.h[1]          // .....................................................................~.........................'......................................................................*.........................'......................................................................~..................
        // srshr   v25.8h,    v25.8h,    #11          // .........................................................................~.....................'..........................................................................*.....................'..........................................................................~..............
        // mls     v8.8h, v25.8h,    v7.h[0]          // ...............................................................................~...............'................................................................................*...............'................................................................................~........
        // str q8, [x3], #(64)                        // .....................................................................................~.........'......................................................................................*.........'......................................................................................~..
        // str q9, [x3, #(-64 + 16*1)]                // ............................................................................~..................'.............................................................................~..................'.............................................................................l...........
        // str q10, [x3, #(-64 + 16*2)]               // ......................................................~........................................'.......................................................~........................................'.......................................................l.................................
        // str q11, [x3, #(-64 + 16*3)]               // .......................................................................................~.......'........................................................................................~.......'........................................................................................l

        subs count, count, 1
        cbnz count, intt_layer4567_start
                                                // Instructions:    44
                                                // Expected cycles: 48
                                                // Expected IPC:    0.92
                                                //
                                                // Cycle bound:     48.0
                                                // IPC bound:       0.92
                                                //
                                                // Wall time:     9.67s
                                                // User time:     9.67s
                                                //
                                                // -------------- cycle (expected) --------------->
                                                // 0                        25
                                                // |------------------------|----------------------
        ldr q2, [x1], #16                       // *...............................................
        sub v10.8H, v23.8H, v1.8H               // ..*.............................................
        sub v1.8H, v12.8H, v9.8H                // ...*............................................
        mul v18.8H, v19.8H, v2.H[0]             // ....*...........................................
        sqrdmulh v31.8H, v19.8H, v2.H[1]        // .....*..........................................
        mul v6.8H, v15.8H, v2.H[4]              // ......*.........................................
        sqrdmulh v21.8H, v15.8H, v2.H[5]        // .......*........................................
        sqrdmulh v13.8H, v20.8H, v2.H[3]        // ........*.......................................
        mls v18.8H, v31.8H, v7.H[0]             // .........*......................................
        mul v15.8H, v20.8H, v2.H[2]             // ..........*.....................................
        mls v6.8H, v21.8H, v7.H[0]              // ...........*....................................
        add v20.8H, v12.8H, v9.8H               // ............*...................................
        sub v25.8H, v3.8H, v24.8H               // .............*..................................
        mls v15.8H, v13.8H, v7.H[0]             // ..............*.................................
        sqdmulh v13.8H, v20.8H, v7.H[1]         // ...............*................................
        ldr q5, [x1], #16                       // ................*...............................
        sub v9.8H, v15.8H, v6.8H                // ..................*.............................
        add v12.8H, v15.8H, v6.8H               // ...................*............................
        srshr v21.8H, v13.8H, #11               // ....................*...........................
        sqrdmulh v31.8H, v9.8H, v2.H[1]         // .....................*..........................
        mul v15.8H, v9.8H, v2.H[0]              // ......................*.........................
        str q12, [x3, #-48]                     // .......................*........................
        mul v12.8H, v10.8H, v5.H[4]             // ........................*.......................
        sqrdmulh v10.8H, v10.8H, v5.H[5]        // .........................*......................
        sqrdmulh v13.8H, v25.8H, v5.H[3]        // ..........................*.....................
        mul v6.8H, v25.8H, v5.H[2]              // ...........................*....................
        mls v20.8H, v21.8H, v7.H[0]             // ............................*...................
        mls v15.8H, v31.8H, v7.H[0]             // .............................*..................
        mls v12.8H, v10.8H, v7.H[0]             // ..............................*.................
        mls v6.8H, v13.8H, v7.H[0]              // ...............................*................
        sqrdmulh v13.8H, v1.8H, v5.H[1]         // ................................*...............
        mul v9.8H, v1.8H, v5.H[0]               // .................................*..............
        str q20, [x3], #(64)                    // ..................................*.............
        sub v10.8H, v6.8H, v12.8H               // ...................................*............
        str q15, [x3, #-80]                     // ....................................*...........
        mls v9.8H, v13.8H, v7.H[0]              // .....................................*..........
        sqrdmulh v13.8H, v10.8H, v5.H[1]        // ......................................*.........
        mul v3.8H, v10.8H, v5.H[0]              // .......................................*........
        str q18, [x3, #-96]                     // ........................................*.......
        add v10.8H, v6.8H, v12.8H               // .........................................*......
        str q9, [x3, #-32]                      // ..........................................*.....
        mls v3.8H, v13.8H, v7.H[0]              // ...........................................*....
        str q10, [x3, #-48]                     // .............................................*..
        str q3, [x3, #-16]                      // ...............................................*

                                                  // -------------- cycle (expected) --------------->
                                                  // 0                        25
                                                  // |------------------------|----------------------
        // ldr q10, [x1], #16                     // *...............................................
        // sqrdmulh v22.8H, v19.8H, v10.H[1]      // .....*..........................................
        // mul v18.8H, v19.8H, v10.H[0]           // ....*...........................................
        // mul v5.8H, v15.8H, v10.H[4]            // ......*.........................................
        // mls v18.8H, v22.8H, v7.H[0]            // .........*......................................
        // sqrdmulh v21.8H, v15.8H, v10.H[5]      // .......*........................................
        // sub v15.8H, v23.8H, v1.8H              // ..*.............................................
        // mls v5.8H, v21.8H, v7.H[0]             // ...........*....................................
        // sqrdmulh v16.8H, v20.8H, v10.H[3]      // ........*.......................................
        // mul v4.8H, v20.8H, v10.H[2]            // ..........*.....................................
        // str q18, [x3, #-32]                    // ........................................*.......
        // mls v4.8H, v16.8H, v7.H[0]             // ..............*.................................
        // sub v19.8H, v12.8H, v9.8H              // ...*............................................
        // sub v20.8H, v3.8H, v24.8H              // .............*..................................
        // sub v18.8H, v4.8H, v5.8H               // ..................*.............................
        // add v1.8H, v4.8H, v5.8H                // ...................*............................
        // add v23.8H, v12.8H, v9.8H              // ............*...................................
        // sqrdmulh v31.8H, v18.8H, v10.H[1]      // .....................*..........................
        // sqdmulh v28.8H, v23.8H, v7.H[1]        // ...............*................................
        // mul v2.8H, v18.8H, v10.H[0]            // ......................*.........................
        // srshr v22.8H, v28.8H, #11              // ....................*...........................
        // str q1, [x3, #-48]                     // .......................*........................
        // mls v23.8H, v22.8H, v7.H[0]            // ............................*...................
        // mls v2.8H, v31.8H, v7.H[0]             // .............................*..................
        // str q23, [x3], #(64)                   // ..................................*.............
        // str q2, [x3, #-80]                     // ....................................*...........
        // ldr q10, [x1], #16                     // ................*...............................
        // sqrdmulh v22.8H, v19.8H, v10.H[1]      // ................................*...............
        // mul v18.8H, v19.8H, v10.H[0]           // .................................*..............
        // mul v5.8H, v15.8H, v10.H[4]            // ........................*.......................
        // mls v18.8H, v22.8H, v7.H[0]            // .....................................*..........
        // sqrdmulh v21.8H, v15.8H, v10.H[5]      // .........................*......................
        // mls v5.8H, v21.8H, v7.H[0]             // ..............................*.................
        // sqrdmulh v16.8H, v20.8H, v10.H[3]      // ..........................*.....................
        // mul v4.8H, v20.8H, v10.H[2]            // ...........................*....................
        // str q18, [x3, #-32]                    // ..........................................*.....
        // mls v4.8H, v16.8H, v7.H[0]             // ...............................*................
        // sub v18.8H, v4.8H, v5.8H               // ...................................*............
        // add v1.8H, v4.8H, v5.8H                // .........................................*......
        // sqrdmulh v31.8H, v18.8H, v10.H[1]      // ......................................*.........
        // mul v2.8H, v18.8H, v10.H[0]            // .......................................*........
        // str q1, [x3, #-48]                     // .............................................*..
        // mls v2.8H, v31.8H, v7.H[0]             // ...........................................*....
        // str q2, [x3, #-16]                     // ...............................................*


        // ---------------------------------------------------------------------

        mov count, #4
        load_roots_123

        .p2align 2

                                                // Instructions:    116
                                                // Expected cycles: 132
                                                // Expected IPC:    0.88
                                                //
                                                // Cycle bound:     132.0
                                                // IPC bound:       0.88
                                                //
                                                // Wall time:     1.96s
                                                // User time:     1.96s
                                                //
                                                // -------------------------------------------------------- cycle (expected) --------------------------------------------------------->
                                                // 0                        25                       50                       75                       100                      125
                                                // |------------------------|------------------------|------------------------|------------------------|------------------------|------
        ldr q14, [x0, #128]                     // *...................................................................................................................................
        ldr q21, [x0, #192]                     // ..*.................................................................................................................................
        ldr q31, [x0, #448]                     // ....*...............................................................................................................................
        sub v26.8H, v14.8H, v21.8H              // ......*.............................................................................................................................
        add v25.8H, v14.8H, v21.8H              // .......*............................................................................................................................
        ldr q27, [x0, #64]                      // ........*...........................................................................................................................
        ldr q14, [x0, #384]                     // ..........*.........................................................................................................................
        ldr q16, [x0, #320]                     // ............*.......................................................................................................................
        sub v22.8H, v14.8H, v31.8H              // ..............*.....................................................................................................................
        add v4.8H, v14.8H, v31.8H               // ...............*....................................................................................................................
        ldr q31, [x0, #0]                       // ................*...................................................................................................................
        mul v18.8H, v26.8H, v1.H[0]             // ..................*.................................................................................................................
        sqrdmulh v8.8H, v26.8H, v1.H[1]         // ...................*................................................................................................................
        add v28.8H, v31.8H, v27.8H              // ....................*...............................................................................................................
        sub v10.8H, v31.8H, v27.8H              // .....................*..............................................................................................................
        sqrdmulh v13.8H, v22.8H, v1.H[5]        // ......................*.............................................................................................................
        sub v30.8H, v28.8H, v25.8H              // .......................*............................................................................................................
        add v17.8H, v28.8H, v25.8H              // ........................*...........................................................................................................
        ldr q5, [x0, #256]                      // .........................*..........................................................................................................
        mul v31.8H, v22.8H, v1.H[4]             // ...........................*........................................................................................................
        mul v26.8H, v10.8H, v0.H[6]             // ............................*.......................................................................................................
        add v6.8H, v5.8H, v16.8H                // .............................*......................................................................................................
        sub v15.8H, v5.8H, v16.8H               // ..............................*.....................................................................................................
        sqrdmulh v19.8H, v10.8H, v0.H[7]        // ...............................*....................................................................................................
        add v12.8H, v6.8H, v4.8H                // ................................*...................................................................................................
        sub v29.8H, v6.8H, v4.8H                // .................................*..................................................................................................
        mul v25.8H, v15.8H, v1.H[2]             // ..................................*.................................................................................................
        ldr q22, [x0, #208]                     // ...................................*................................................................................................
        mls v18.8H, v8.8H, v7.H[0]              // .....................................*..............................................................................................
        ldr q5, [x0, #16]                       // ......................................*.............................................................................................
        sqrdmulh v8.8H, v15.8H, v1.H[3]         // ........................................*...........................................................................................
        ldr q20, [x0, #464]                     // .........................................*..........................................................................................
        ldr q15, [x0, #272]                     // ...........................................*........................................................................................
        mls v31.8H, v13.8H, v7.H[0]             // .............................................*......................................................................................
        ldr q16, [x0, #80]                      // ..............................................*.....................................................................................
        sqdmulh v6.8H, v17.8H, v7.H[1]          // ................................................*...................................................................................
        ldr q23, [x0, #144]                     // .................................................*..................................................................................
        mul v21.8H, v30.8H, v0.H[2]             // ...................................................*................................................................................
        srshr v3.8H, v6.8H, #11                 // ....................................................*...............................................................................
        sqrdmulh v11.8H, v30.8H, v0.H[3]        // .....................................................*..............................................................................
        sub v27.8H, v5.8H, v16.8H               // ......................................................*.............................................................................
        mls v17.8H, v3.8H, v7.H[0]              // .......................................................*............................................................................
        mls v26.8H, v19.8H, v7.H[0]             // ........................................................*...........................................................................
        mls v25.8H, v8.8H, v7.H[0]              // .........................................................*..........................................................................
        sub v19.8H, v23.8H, v22.8H              // ..........................................................*.........................................................................
        mul v14.8H, v27.8H, v0.H[6]             // ...........................................................*........................................................................
        ldr q28, [x0, #336]                     // ............................................................*.......................................................................
        add v4.8H, v26.8H, v18.8H               // ..............................................................*.....................................................................
        sub v18.8H, v26.8H, v18.8H              // ...............................................................*....................................................................
        ldr q30, [x0, #400]                     // ................................................................*...................................................................
        sub v13.8H, v17.8H, v12.8H              // ..................................................................*.................................................................
        add v8.8H, v17.8H, v12.8H               // ...................................................................*................................................................
        mul v3.8H, v29.8H, v0.H[4]              // ....................................................................*...............................................................
        sqrdmulh v17.8H, v29.8H, v0.H[5]        // .....................................................................*..............................................................
        add v9.8H, v23.8H, v22.8H               // ......................................................................*.............................................................
        sub v12.8H, v25.8H, v31.8H              // .......................................................................*............................................................
        sub v2.8H, v15.8H, v28.8H               // ........................................................................*...........................................................
        sub v29.8H, v30.8H, v20.8H              // .........................................................................*..........................................................
        sqrdmulh v6.8H, v27.8H, v0.H[7]         // ..........................................................................*.........................................................
        sqrdmulh v23.8H, v19.8H, v1.H[1]        // ...........................................................................*........................................................
        add v27.8H, v5.8H, v16.8H               // ............................................................................*.......................................................
        mul v26.8H, v19.8H, v1.H[0]             // .............................................................................*......................................................
        sqrdmulh v24.8H, v12.8H, v0.H[5]        // ..............................................................................*.....................................................
        mul v19.8H, v2.8H, v1.H[2]              // ...............................................................................*....................................................
        mul v16.8H, v18.8H, v0.H[2]             // ................................................................................*...................................................
        sqrdmulh v5.8H, v29.8H, v1.H[5]         // .................................................................................*..................................................
        add v20.8H, v30.8H, v20.8H              // ..................................................................................*.................................................
        sqrdmulh v30.8H, v2.8H, v1.H[3]         // ...................................................................................*................................................
        mul v2.8H, v29.8H, v1.H[4]              // ....................................................................................*...............................................
        mls v14.8H, v6.8H, v7.H[0]              // .....................................................................................*..............................................
        add v29.8H, v15.8H, v28.8H              // ......................................................................................*.............................................
        sqrdmulh v28.8H, v18.8H, v0.H[3]        // .......................................................................................*............................................
        mls v19.8H, v30.8H, v7.H[0]             // ........................................................................................*...........................................
        mls v26.8H, v23.8H, v7.H[0]             // .........................................................................................*..........................................
        add v10.8H, v25.8H, v31.8H              // ..........................................................................................*.........................................
        mls v2.8H, v5.8H, v7.H[0]               // ...........................................................................................*........................................
        mls v21.8H, v11.8H, v7.H[0]             // ............................................................................................*.......................................
        sub v25.8H, v29.8H, v20.8H              // .............................................................................................*......................................
        mul v23.8H, v12.8H, v0.H[4]             // ..............................................................................................*.....................................
        mls v16.8H, v28.8H, v7.H[0]             // ...............................................................................................*....................................
        mls v3.8H, v17.8H, v7.H[0]              // ................................................................................................*...................................
        mul v18.8H, v13.8H, v0.H[0]             // .................................................................................................*..................................
        mul v17.8H, v25.8H, v0.H[4]             // ..................................................................................................*.................................
        sqrdmulh v11.8H, v25.8H, v0.H[5]        // ...................................................................................................*................................
        sub v31.8H, v19.8H, v2.8H               // ....................................................................................................*...............................
        sqrdmulh v28.8H, v13.8H, v0.H[1]        // .....................................................................................................*..............................
        add v12.8H, v21.8H, v3.8H               // ......................................................................................................*.............................
        sub v6.8H, v21.8H, v3.8H                // .......................................................................................................*............................
        sub v21.8H, v27.8H, v9.8H               // ........................................................................................................*...........................
        sqrdmulh v13.8H, v31.8H, v0.H[5]        // .........................................................................................................*..........................
        sub v25.8H, v14.8H, v26.8H              // ..........................................................................................................*.........................
        mul v3.8H, v31.8H, v0.H[4]              // ...........................................................................................................*........................
        mls v17.8H, v11.8H, v7.H[0]             // ............................................................................................................*.......................
        mls v23.8H, v24.8H, v7.H[0]             // .............................................................................................................*......................
        sqrdmulh v24.8H, v25.8H, v0.H[3]        // ..............................................................................................................*.....................
        mul v15.8H, v25.8H, v0.H[2]             // ...............................................................................................................*....................
        sqrdmulh v5.8H, v21.8H, v0.H[3]         // ................................................................................................................*...................
        add v11.8H, v16.8H, v23.8H              // .................................................................................................................*..................
        mls v3.8H, v13.8H, v7.H[0]              // ..................................................................................................................*.................
        sub v30.8H, v16.8H, v23.8H              // ...................................................................................................................*................
        mls v15.8H, v24.8H, v7.H[0]             // ....................................................................................................................*...............
        str q11, [x0, #192]                     // .....................................................................................................................*..............
        add v23.8H, v27.8H, v9.8H               // ......................................................................................................................*.............
        sqrdmulh v16.8H, v30.8H, v0.H[1]        // .......................................................................................................................*............
        add v24.8H, v4.8H, v10.8H               // ........................................................................................................................*...........
        sub v13.8H, v15.8H, v3.8H               // .........................................................................................................................*..........
        str q8, [x0], #(16)                     // ..........................................................................................................................*.........
        mul v8.8H, v30.8H, v0.H[0]              // ...........................................................................................................................*........
        mls v18.8H, v28.8H, v7.H[0]             // ............................................................................................................................*.......
        str q12, [x0, #112]                     // .............................................................................................................................*......
        add v20.8H, v29.8H, v20.8H              // ..............................................................................................................................*.....
        mls v8.8H, v16.8H, v7.H[0]              // ...............................................................................................................................*....
        add v3.8H, v15.8H, v3.8H                // ................................................................................................................................*...
        str q24, [x0, #48]                      // .................................................................................................................................*..
        sqrdmulh v12.8H, v6.8H, v0.H[1]         // ..................................................................................................................................*.
        str q8, [x0, #432]                      // ...................................................................................................................................*

                                                 // -------------------------------------------------------- cycle (expected) --------------------------------------------------------->
                                                 // 0                        25                       50                       75                       100                      125
                                                 // |------------------------|------------------------|------------------------|------------------------|------------------------|------
        // ldr q18, [x0, #128]                   // *...................................................................................................................................
        // ldr q10, [x0, #192]                   // ..*.................................................................................................................................
        // sub v8.8H, v18.8H, v10.8H             // ......*.............................................................................................................................
        // add v29.8H, v18.8H, v10.8H            // .......*............................................................................................................................
        // mul v26.8H, v8.8H, v1.H[0]            // ..................*.................................................................................................................
        // sqrdmulh v11.8H, v8.8H, v1.H[1]       // ...................*................................................................................................................
        // ldr q28, [x0, #0]                     // ................*...................................................................................................................
        // mls v26.8H, v11.8H, v7.H[0]           // .....................................*..............................................................................................
        // ldr q27, [x0, #64]                    // ........*...........................................................................................................................
        // add v20.8H, v28.8H, v27.8H            // ....................*...............................................................................................................
        // sub v31.8H, v28.8H, v27.8H            // .....................*..............................................................................................................
        // sub v21.8H, v20.8H, v29.8H            // .......................*............................................................................................................
        // sqrdmulh v30.8H, v31.8H, v0.H[7]      // ...............................*....................................................................................................
        // add v23.8H, v20.8H, v29.8H            // ........................*...........................................................................................................
        // mul v14.8H, v31.8H, v0.H[6]           // ............................*.......................................................................................................
        // ldr q24, [x0, #448]                   // ....*...............................................................................................................................
        // ldr q15, [x0, #320]                   // ............*.......................................................................................................................
        // ldr q22, [x0, #256]                   // .........................*..........................................................................................................
        // ldr q25, [x0, #384]                   // ..........*.........................................................................................................................
        // mls v14.8H, v30.8H, v7.H[0]           // ........................................................*...........................................................................
        // add v5.8H, v22.8H, v15.8H             // .............................*......................................................................................................
        // add v28.8H, v25.8H, v24.8H            // ...............*....................................................................................................................
        // sub v30.8H, v22.8H, v15.8H            // ..............................*.....................................................................................................
        // sub v25.8H, v25.8H, v24.8H            // ..............*.....................................................................................................................
        // sub v29.8H, v5.8H, v28.8H             // .................................*..................................................................................................
        // mul v19.8H, v30.8H, v1.H[2]           // ..................................*.................................................................................................
        // mul v2.8H, v25.8H, v1.H[4]            // ...........................*........................................................................................................
        // sqrdmulh v27.8H, v30.8H, v1.H[3]      // ........................................*...........................................................................................
        // sqrdmulh v31.8H, v25.8H, v1.H[5]      // ......................*.............................................................................................................
        // sqrdmulh v24.8H, v29.8H, v0.H[5]      // .....................................................................*..............................................................
        // mul v17.8H, v29.8H, v0.H[4]           // ....................................................................*...............................................................
        // mls v2.8H, v31.8H, v7.H[0]            // .............................................*......................................................................................
        // mls v19.8H, v27.8H, v7.H[0]           // .........................................................*..........................................................................
        // add v20.8H, v5.8H, v28.8H             // ................................*...................................................................................................
        // sqrdmulh v5.8H, v21.8H, v0.H[3]       // .....................................................*..............................................................................
        // sub v25.8H, v14.8H, v26.8H            // ...............................................................*....................................................................
        // sub v22.8H, v19.8H, v2.8H             // .......................................................................*............................................................
        // mul v29.8H, v25.8H, v0.H[2]           // ................................................................................*...................................................
        // mul v16.8H, v22.8H, v0.H[4]           // ..............................................................................................*.....................................
        // sqrdmulh v27.8H, v22.8H, v0.H[5]      // ..............................................................................*.....................................................
        // sqrdmulh v15.8H, v25.8H, v0.H[3]      // .......................................................................................*............................................
        // mls v16.8H, v27.8H, v7.H[0]           // .............................................................................................................*......................
        // mls v29.8H, v15.8H, v7.H[0]           // ...............................................................................................*....................................
        // mls v17.8H, v24.8H, v7.H[0]           // ................................................................................................*...................................
        // add v3.8H, v29.8H, v16.8H             // .................................................................................................................*..................
        // sub v13.8H, v29.8H, v16.8H            // ...................................................................................................................*................
        // sqdmulh v24.8H, v23.8H, v7.H[1]       // ................................................*...................................................................................
        // ldr q18, [x0, #144]                   // .................................................*..................................................................................
        // srshr v4.8H, v24.8H, #11              // ....................................................*...............................................................................
        // ldr q10, [x0, #208]                   // ...................................*................................................................................................
        // mls v23.8H, v4.8H, v7.H[0]            // .......................................................*............................................................................
        // add v4.8H, v14.8H, v26.8H             // ..............................................................*.....................................................................
        // sub v8.8H, v18.8H, v10.8H             // ..........................................................*.........................................................................
        // add v29.8H, v18.8H, v10.8H            // ......................................................................*.............................................................
        // sub v22.8H, v23.8H, v20.8H            // ..................................................................*.................................................................
        // mul v26.8H, v8.8H, v1.H[0]            // .............................................................................*......................................................
        // sqrdmulh v11.8H, v8.8H, v1.H[1]       // ...........................................................................*........................................................
        // ldr q28, [x0, #16]                    // ......................................*.............................................................................................
        // add v24.8H, v23.8H, v20.8H            // ...................................................................*................................................................
        // mls v26.8H, v11.8H, v7.H[0]           // .........................................................................................*..........................................
        // ldr q27, [x0, #80]                    // ..............................................*.....................................................................................
        // sqrdmulh v9.8H, v22.8H, v0.H[1]       // .....................................................................................................*..............................
        // mul v8.8H, v21.8H, v0.H[2]            // ...................................................*................................................................................
        // mul v18.8H, v22.8H, v0.H[0]           // .................................................................................................*..................................
        // add v20.8H, v28.8H, v27.8H            // ............................................................................*.......................................................
        // sub v31.8H, v28.8H, v27.8H            // ......................................................*.............................................................................
        // sub v21.8H, v20.8H, v29.8H            // ........................................................................................................*...........................
        // sqrdmulh v30.8H, v31.8H, v0.H[7]      // ..........................................................................*.........................................................
        // add v23.8H, v20.8H, v29.8H            // ......................................................................................................................*.............
        // str q24, [x0], #(16)                  // ..........................................................................................................................*.........
        // mul v14.8H, v31.8H, v0.H[6]           // ...........................................................*........................................................................
        // mls v8.8H, v5.8H, v7.H[0]             // ............................................................................................*.......................................
        // ldr q24, [x0, #448]                   // .........................................*..........................................................................................
        // ldr q15, [x0, #320]                   // ............................................................*.......................................................................
        // ldr q22, [x0, #256]                   // ...........................................*........................................................................................
        // mls v18.8H, v9.8H, v7.H[0]            // ............................................................................................................................*.......
        // ldr q25, [x0, #384]                   // ................................................................*...................................................................
        // mls v14.8H, v30.8H, v7.H[0]           // .....................................................................................*..............................................
        // add v5.8H, v22.8H, v15.8H             // ......................................................................................*.............................................
        // sub v6.8H, v8.8H, v17.8H              // .......................................................................................................*............................
        // add v28.8H, v25.8H, v24.8H            // ..................................................................................*.................................................
        // add v10.8H, v19.8H, v2.8H             // ..........................................................................................*.........................................
        // sub v30.8H, v22.8H, v15.8H            // ........................................................................*...........................................................
        // sub v25.8H, v25.8H, v24.8H            // .........................................................................*..........................................................
        // sub v29.8H, v5.8H, v28.8H             // .............................................................................................*......................................
        // mul v19.8H, v30.8H, v1.H[2]           // ...............................................................................*....................................................
        // mul v2.8H, v25.8H, v1.H[4]            // ....................................................................................*...............................................
        // sqrdmulh v27.8H, v30.8H, v1.H[3]      // ...................................................................................*................................................
        // sqrdmulh v31.8H, v25.8H, v1.H[5]      // .................................................................................*..................................................
        // sqrdmulh v24.8H, v29.8H, v0.H[5]      // ...................................................................................................*................................
        // add v15.8H, v8.8H, v17.8H             // ......................................................................................................*.............................
        // mul v17.8H, v29.8H, v0.H[4]           // ..................................................................................................*.................................
        // mls v2.8H, v31.8H, v7.H[0]            // ...........................................................................................*........................................
        // str q15, [x0, #112]                   // .............................................................................................................................*......
        // mls v19.8H, v27.8H, v7.H[0]           // ........................................................................................*...........................................
        // add v20.8H, v5.8H, v28.8H             // ..............................................................................................................................*.....
        // add v11.8H, v4.8H, v10.8H             // ........................................................................................................................*...........
        // sqrdmulh v12.8H, v6.8H, v0.H[1]       // ..................................................................................................................................*.
        // sqrdmulh v5.8H, v21.8H, v0.H[3]       // ................................................................................................................*...................
        // sub v25.8H, v14.8H, v26.8H            // ..........................................................................................................*.........................
        // sub v22.8H, v19.8H, v2.8H             // ....................................................................................................*...............................
        // sqrdmulh v28.8H, v13.8H, v0.H[1]      // .......................................................................................................................*............
        // mul v29.8H, v25.8H, v0.H[2]           // ...............................................................................................................*....................
        // mul v16.8H, v22.8H, v0.H[4]           // ...........................................................................................................*........................
        // sqrdmulh v27.8H, v22.8H, v0.H[5]      // .........................................................................................................*..........................
        // sqrdmulh v15.8H, v25.8H, v0.H[3]      // ..............................................................................................................*.....................
        // mul v8.8H, v13.8H, v0.H[0]            // ...........................................................................................................................*........
        // str q3, [x0, #176]                    // .....................................................................................................................*..............
        // mls v16.8H, v27.8H, v7.H[0]           // ..................................................................................................................*.................
        // mls v29.8H, v15.8H, v7.H[0]           // ....................................................................................................................*...............
        // mls v8.8H, v28.8H, v7.H[0]            // ...............................................................................................................................*....
        // mls v17.8H, v24.8H, v7.H[0]           // ............................................................................................................*.......................
        // str q11, [x0, #48]                    // .................................................................................................................................*..
        // add v3.8H, v29.8H, v16.8H             // ................................................................................................................................*...
        // str q8, [x0, #432]                    // ...................................................................................................................................*
        // sub v13.8H, v29.8H, v16.8H            // .........................................................................................................................*..........

        sub count, count, #2
intt_layer123_start:
                                                // Instructions:    79
                                                // Expected cycles: 87
                                                // Expected IPC:    0.91
                                                //
                                                // Cycle bound:     87.0
                                                // IPC bound:       0.91
                                                //
                                                // Wall time:     9.53s
                                                // User time:     9.53s
                                                //
                                                // ---------------------------------- cycle (expected) ---------------------------------->
                                                // 0                        25                       50                       75
                                                // |------------------------|------------------------|------------------------|-----------
        str q18, [x0, #240]                     // l......................................................................................
        sqdmulh v24.8H, v23.8H, v7.H[1]         // .*.....................................................................................
        ldr q18, [x0, #144]                     // ..e....................................................................................
        sub v16.8H, v4.8H, v10.8H               // ....l..................................................................................
        srshr v4.8H, v24.8H, #11                // .....*.................................................................................
        ldr q10, [x0, #208]                     // ......e................................................................................
        mls v23.8H, v4.8H, v7.H[0]              // ........*..............................................................................
        add v4.8H, v14.8H, v26.8H               // .........*.............................................................................
        sub v8.8H, v18.8H, v10.8H               // ..........e............................................................................
        add v29.8H, v18.8H, v10.8H              // ...........e...........................................................................
        sub v22.8H, v23.8H, v20.8H              // ............*..........................................................................
        mul v26.8H, v8.8H, v1.H[0]              // .............e.........................................................................
        sqrdmulh v11.8H, v8.8H, v1.H[1]         // ..............e........................................................................
        ldr q28, [x0, #16]                      // ...............e.......................................................................
        add v24.8H, v23.8H, v20.8H              // .................*.....................................................................
        mls v26.8H, v11.8H, v7.H[0]             // ..................e....................................................................
        ldr q27, [x0, #80]                      // ...................e...................................................................
        sqrdmulh v9.8H, v22.8H, v0.H[1]         // .....................*.................................................................
        mul v8.8H, v21.8H, v0.H[2]              // ......................*................................................................
        mul v23.8H, v6.8H, v0.H[0]              // .......................l...............................................................
        mul v18.8H, v22.8H, v0.H[0]             // ........................*..............................................................
        add v20.8H, v28.8H, v27.8H              // .........................e.............................................................
        sub v31.8H, v28.8H, v27.8H              // ..........................e............................................................
        mls v23.8H, v12.8H, v7.H[0]             // ...........................l...........................................................
        sub v21.8H, v20.8H, v29.8H              // ............................e..........................................................
        sqrdmulh v30.8H, v31.8H, v0.H[7]        // .............................e.........................................................
        mul v11.8H, v16.8H, v0.H[0]             // ..............................l........................................................
        str q23, [x0, #368]                     // ...............................l.......................................................
        add v23.8H, v20.8H, v29.8H              // ................................e......................................................
        sqrdmulh v20.8H, v16.8H, v0.H[1]        // .................................l.....................................................
        str q24, [x0], #(16)                    // ..................................*....................................................
        mul v14.8H, v31.8H, v0.H[6]             // ...................................e...................................................
        mls v8.8H, v5.8H, v7.H[0]               // ....................................*..................................................
        ldr q24, [x0, #448]                     // .....................................e.................................................
        ldr q15, [x0, #320]                     // .......................................e...............................................
        ldr q22, [x0, #256]                     // .........................................e.............................................
        mls v18.8H, v9.8H, v7.H[0]              // ...........................................*...........................................
        ldr q25, [x0, #384]                     // ............................................e..........................................
        mls v11.8H, v20.8H, v7.H[0]             // ..............................................l........................................
        mls v14.8H, v30.8H, v7.H[0]             // ...............................................e.......................................
        add v5.8H, v22.8H, v15.8H               // ................................................e......................................
        sub v6.8H, v8.8H, v17.8H                // .................................................*.....................................
        add v28.8H, v25.8H, v24.8H              // ..................................................e....................................
        add v10.8H, v19.8H, v2.8H               // ...................................................*...................................
        sub v30.8H, v22.8H, v15.8H              // ....................................................e..................................
        sub v25.8H, v25.8H, v24.8H              // .....................................................e.................................
        sub v29.8H, v5.8H, v28.8H               // ......................................................e................................
        mul v19.8H, v30.8H, v1.H[2]             // .......................................................e...............................
        mul v2.8H, v25.8H, v1.H[4]              // ........................................................e..............................
        sqrdmulh v27.8H, v30.8H, v1.H[3]        // .........................................................e.............................
        sqrdmulh v31.8H, v25.8H, v1.H[5]        // ..........................................................e............................
        sqrdmulh v24.8H, v29.8H, v0.H[5]        // ...........................................................e...........................
        add v15.8H, v8.8H, v17.8H               // ............................................................*..........................
        mul v17.8H, v29.8H, v0.H[4]             // .............................................................e.........................
        mls v2.8H, v31.8H, v7.H[0]              // ..............................................................e........................
        str q15, [x0, #112]                     // ...............................................................*.......................
        mls v19.8H, v27.8H, v7.H[0]             // ................................................................e......................
        str q11, [x0, #288]                     // .................................................................l.....................
        add v20.8H, v5.8H, v28.8H               // ..................................................................e....................
        add v11.8H, v4.8H, v10.8H               // ...................................................................*...................
        sqrdmulh v12.8H, v6.8H, v0.H[1]         // ....................................................................*..................
        sqrdmulh v5.8H, v21.8H, v0.H[3]         // .....................................................................e.................
        sub v25.8H, v14.8H, v26.8H              // ......................................................................e................
        sub v22.8H, v19.8H, v2.8H               // .......................................................................e...............
        sqrdmulh v28.8H, v13.8H, v0.H[1]        // ........................................................................*..............
        mul v29.8H, v25.8H, v0.H[2]             // .........................................................................e.............
        mul v16.8H, v22.8H, v0.H[4]             // ..........................................................................e............
        sqrdmulh v27.8H, v22.8H, v0.H[5]        // ...........................................................................e...........
        sqrdmulh v15.8H, v25.8H, v0.H[3]        // ............................................................................e..........
        mul v8.8H, v13.8H, v0.H[0]              // .............................................................................*.........
        str q3, [x0, #176]                      // ..............................................................................*........
        mls v16.8H, v27.8H, v7.H[0]             // ...............................................................................e.......
        mls v29.8H, v15.8H, v7.H[0]             // ................................................................................e......
        mls v8.8H, v28.8H, v7.H[0]              // .................................................................................*.....
        mls v17.8H, v24.8H, v7.H[0]             // ..................................................................................e....
        str q11, [x0, #48]                      // ...................................................................................*...
        add v3.8H, v29.8H, v16.8H               // ....................................................................................e..
        str q8, [x0, #432]                      // .....................................................................................*.
        sub v13.8H, v29.8H, v16.8H              // ......................................................................................e

                                                      // ------------------------------------------------------------------------------------------------------------- cycle (expected) -------------------------------------------------------------------------------------------------------------->
                                                      // 0                        25                       50                       75                       100                      125                      150                      175                      200                      225
                                                      // |------------------------|------------------------|------------------------|------------------------|------------------------|------------------------|------------------------|------------------------|------------------------|------------
        // ldr q8, [x0, #0]                           // .............e.......................................................................'..............~.......................................................................'..............~..................................................
        // ldr q9, [x0, #(1*(512/8))]                 // .................e...................................................................'..................~...................................................................'..................~..............................................
        // ldr q10, [x0, #(2*(512/8))]                // e....................................................................................'.~....................................................................................'.~...............................................................
        // ldr q11, [x0, #(3*(512/8))]                // ....e................................................................................'.....~................................................................................'.....~...........................................................
        // ldr q12, [x0, #(4*(512/8))]                // .......................................e.............................................'........................................~.............................................'........................................~........................
        // ldr q13, [x0, #(5*(512/8))]                // .....................................e...............................................'......................................~...............................................'......................................~..........................
        // ldr q14, [x0, #(6*(512/8))]                // ..........................................e..........................................'...........................................~..........................................'...........................................~.....................
        // ldr q15, [x0, #(7*(512/8))]                // ...................................e.................................................'....................................~.................................................'....................................~............................
        // sub v24.8h,   v8.8h, v9.8h                 // ........................e............................................................'.........................~............................................................'.........................~.......................................
        // add v8.8h, v8.8h, v9.8h                    // .......................e.............................................................'........................~.............................................................'........................~........................................
        // sqrdmulh v27.8h,      v24.8h, v0.h[7]      // ...........................e.........................................................'............................~.........................................................'............................~....................................
        // mul      v9.8h, v24.8h, v0.h[6]            // .................................e...................................................'..................................~...................................................'..................................~..............................
        // mls      v9.8h, v27.8h,      v7.h[0]       // .............................................e.......................................'..............................................~.......................................'..............................................~..................
        // sub v24.8h,   v10.8h, v11.8h               // ........e............................................................................'.........~............................................................................'.........~.......................................................
        // add v10.8h, v10.8h, v11.8h                 // .........e...........................................................................'..........~...........................................................................'..........~......................................................
        // sqrdmulh v27.8h,      v24.8h, v1.h[1]      // ............e........................................................................'.............~........................................................................'.............~...................................................
        // mul      v11.8h, v24.8h, v1.h[0]           // ...........e.........................................................................'............~.........................................................................'............~....................................................
        // mls      v11.8h, v27.8h,      v7.h[0]      // ................e....................................................................'.................~....................................................................'.................~...............................................
        // sub v24.8h,   v12.8h, v13.8h               // ..................................................e..................................'...................................................~..................................'...................................................~.............
        // add v12.8h, v12.8h, v13.8h                 // ..............................................e......................................'...............................................~......................................'...............................................~.................
        // sqrdmulh v27.8h,      v24.8h, v1.h[3]      // .......................................................e.............................'........................................................~.............................'........................................................~........
        // mul      v13.8h, v24.8h, v1.h[2]           // .....................................................e...............................'......................................................~...............................'......................................................~..........
        // mls      v13.8h, v27.8h,      v7.h[0]      // ..............................................................e......................'...............................................................~......................'...............................................................~.
        // sub v24.8h,   v14.8h, v15.8h               // ...................................................e.................................'....................................................~.................................'....................................................~............
        // add v14.8h, v14.8h, v15.8h                 // ................................................e....................................'.................................................~....................................'.................................................~...............
        // sqrdmulh v27.8h,      v24.8h, v1.h[5]      // ........................................................e............................'.........................................................~............................'.........................................................~.......
        // mul      v15.8h, v24.8h, v1.h[4]           // ......................................................e..............................'.......................................................~..............................'.......................................................~.........
        // mls      v15.8h, v27.8h,      v7.h[0]      // ............................................................e........................'.............................................................~........................'.............................................................~...
        // sub v24.8h,   v8.8h, v10.8h                // ..........................e..........................................................'...........................~..........................................................'...........................~.....................................
        // add v8.8h, v8.8h, v10.8h                   // ..............................e......................................................'...............................~......................................................'...............................~.................................
        // sqrdmulh v27.8h,      v24.8h, v0.h[3]      // ...................................................................e.................'....................................................................~.................'.................................................................
        // mul      v10.8h, v24.8h, v0.h[2]           // ....................~................................................................'.....................*................................................................'.....................~...........................................
        // mls      v10.8h, v27.8h,      v7.h[0]      // ..................................~..................................................'...................................*..................................................'...................................~.............................
        // sub v24.8h,   v9.8h, v11.8h                // ....................................................................e................'.....................................................................~................'.................................................................
        // add v9.8h, v9.8h, v11.8h                   // .......~.............................................................................'........*.............................................................................'........~........................................................
        // sqrdmulh v27.8h,      v24.8h, v0.h[3]      // ..........................................................................e..........'...........................................................................~..........'.................................................................
        // mul      v11.8h, v24.8h, v0.h[2]           // .......................................................................e.............'........................................................................~.............'.................................................................
        // mls      v11.8h, v27.8h,      v7.h[0]      // ..............................................................................e......'...............................................................................~......'.................................................................
        // sub v24.8h,   v12.8h, v14.8h               // ....................................................e................................'.....................................................~................................'.....................................................~...........
        // add v12.8h, v12.8h, v14.8h                 // ................................................................e....................'.................................................................~....................'.................................................................
        // sqrdmulh v27.8h,      v24.8h, v0.h[5]      // .........................................................e...........................'..........................................................~...........................'..........................................................~......
        // mul      v14.8h, v24.8h, v0.h[4]           // ...........................................................e.........................'............................................................~.........................'............................................................~....
        // mls      v14.8h, v27.8h,      v7.h[0]      // ................................................................................e....'.................................................................................~....'.................................................................
        // sub v24.8h,   v13.8h, v15.8h               // .....................................................................e...............'......................................................................~...............'.................................................................
        // add v13.8h, v13.8h, v15.8h                 // .................................................~...................................'..................................................*...................................'..................................................~..............
        // sqrdmulh v27.8h,      v24.8h, v0.h[5]      // .........................................................................e...........'..........................................................................~...........'.................................................................
        // mul      v15.8h, v24.8h, v0.h[4]           // ........................................................................e............'.........................................................................~............'.................................................................
        // mls      v15.8h, v27.8h,      v7.h[0]      // .............................................................................e.......'..............................................................................~.......'.................................................................
        // sqdmulh v25.8h,    v8.8h, v7.h[1]          // .....................................................................................'*.....................................................................................'~................................................................
        // srshr   v25.8h,    v25.8h,    #11          // ...~.................................................................................'....*.................................................................................'....~............................................................
        // mls     v8.8h, v25.8h,    v7.h[0]          // ......~..............................................................................'.......*..............................................................................'.......~.........................................................
        // sub v24.8h,   v8.8h, v12.8h                // ..........~..........................................................................'...........*..........................................................................'...........~.....................................................
        // add v8.8h, v8.8h, v12.8h                   // ...............~.....................................................................'................*.....................................................................'................~................................................
        // sqrdmulh v27.8h,      v24.8h, v0.h[1]      // ...................~.................................................................'....................*.................................................................'....................~............................................
        // mul      v12.8h, v24.8h, v0.h[0]           // ......................~..............................................................'.......................*..............................................................'.......................~.........................................
        // mls      v12.8h, v27.8h,      v7.h[0]      // .........................................~...........................................'..........................................*...........................................'..........................................~......................
        // sub v24.8h,   v9.8h, v13.8h                // ..~..................................................................................'...~..................................................................................'...l.............................................................
        // add v9.8h, v9.8h, v13.8h                   // .................................................................~...................'..................................................................*...................'.................................................................
        // sqrdmulh v27.8h,      v24.8h, v0.h[1]      // ...............................~.....................................................'................................~.....................................................'................................l................................
        // mul      v13.8h, v24.8h, v0.h[0]           // ............................~........................................................'.............................~........................................................'.............................l...................................
        // mls      v13.8h, v27.8h,      v7.h[0]      // ............................................~........................................'.............................................~........................................'.............................................l...................
        // sub v24.8h,   v10.8h, v14.8h               // ...............................................~.....................................'................................................*.....................................'................................................~................
        // add v10.8h, v10.8h, v14.8h                 // ..........................................................~..........................'...........................................................*..........................'...........................................................~.....
        // sqrdmulh v27.8h,      v24.8h, v0.h[1]      // ..................................................................~..................'...................................................................*..................'.................................................................
        // mul      v14.8h, v24.8h, v0.h[0]           // .....................~...............................................................'......................~...............................................................'......................l..........................................
        // mls      v14.8h, v27.8h,      v7.h[0]      // .........................~...........................................................'..........................~...........................................................'..........................l......................................
        // sub v24.8h,   v11.8h, v15.8h               // ....................................................................................e'.....................................................................................~'.................................................................
        // add v11.8h, v11.8h, v15.8h                 // ..................................................................................e..'...................................................................................~..'.................................................................
        // sqrdmulh v27.8h,      v24.8h, v0.h[1]      // ......................................................................~..............'.......................................................................*..............'.................................................................
        // mul      v15.8h, v24.8h, v0.h[0]           // ...........................................................................~.........'............................................................................*.........'.................................................................
        // mls      v15.8h, v27.8h,      v7.h[0]      // ...............................................................................~.....'................................................................................*.....'.................................................................
        // str q12, [x0, #(4*(512/8))]                // .....................................................................................~......................................................................................l.................................................................
        // str q13, [x0, #(5*(512/8))]                // ...............................................................~.....................'................................................................~.....................'................................................................l
        // str q14, [x0, #(6*(512/8))]                // .............................~.......................................................'..............................~.......................................................'..............................l..................................
        // str q15, [x0, #(7*(512/8))]                // ...................................................................................~.'....................................................................................*.'.................................................................
        // str q8, [x0], #(16)                        // ................................~....................................................'.................................*....................................................'.................................~...............................
        // str q9, [x0, #(-16 + 1*(512/8))]           // .................................................................................~...'..................................................................................*...'.................................................................
        // str q10, [x0, #(-16 + 2*(512/8))]          // .............................................................~.......................'..............................................................*.......................'..............................................................~..
        // str q11, [x0, #(-16 + 3*(512/8))]          // ............................................................................~........'.............................................................................*........'.................................................................

        subs count, count, 1
        cbnz count, intt_layer123_start
                                                // Instructions:    42
                                                // Expected cycles: 44
                                                // Expected IPC:    0.95
                                                //
                                                // Cycle bound:     44.0
                                                // IPC bound:       0.95
                                                //
                                                // Wall time:     8.32s
                                                // User time:     8.32s
                                                //
                                                // ------------ cycle (expected) ------------->
                                                // 0                        25
                                                // |------------------------|------------------
        add v8.8H, v14.8H, v26.8H               // *...........................................
        add v15.8H, v19.8H, v2.8H               // .*..........................................
        str q18, [x0, #240]                     // ..*.........................................
        sub v28.8H, v4.8H, v10.8H               // ...*........................................
        mul v29.8H, v21.8H, v0.H[2]             // ....*.......................................
        str q3, [x0, #192]                      // .....*......................................
        sqrdmulh v14.8H, v13.8H, v0.H[1]        // ......*.....................................
        mul v13.8H, v13.8H, v0.H[0]             // .......*....................................
        mul v21.8H, v6.8H, v0.H[0]              // ........*...................................
        mls v29.8H, v5.8H, v7.H[0]              // .........*..................................
        sqdmulh v3.8H, v23.8H, v7.H[1]          // ..........*.................................
        add v10.8H, v8.8H, v15.8H               // ...........*................................
        mls v21.8H, v12.8H, v7.H[0]             // ............*...............................
        add v30.8H, v29.8H, v17.8H              // .............*..............................
        srshr v11.8H, v3.8H, #11                // ..............*.............................
        sub v29.8H, v29.8H, v17.8H              // ...............*............................
        sub v2.8H, v8.8H, v15.8H                // ................*...........................
        mls v23.8H, v11.8H, v7.H[0]             // .................*..........................
        mls v13.8H, v14.8H, v7.H[0]             // ..................*.........................
        sqrdmulh v19.8H, v28.8H, v0.H[1]        // ...................*........................
        mul v17.8H, v28.8H, v0.H[0]             // ....................*.......................
        add v14.8H, v23.8H, v20.8H              // .....................*......................
        sub v25.8H, v23.8H, v20.8H              // ......................*.....................
        str q10, [x0, #64]                      // .......................*....................
        sqrdmulh v4.8H, v29.8H, v0.H[1]         // ........................*...................
        str q21, [x0, #368]                     // .........................*..................
        sqrdmulh v20.8H, v2.8H, v0.H[1]         // ..........................*.................
        str q30, [x0, #128]                     // ...........................*................
        mul v10.8H, v29.8H, v0.H[0]             // ............................*...............
        sqrdmulh v21.8H, v25.8H, v0.H[1]        // .............................*..............
        mls v17.8H, v19.8H, v7.H[0]             // ..............................*.............
        str q14, [x0], #(16)                    // ...............................*............
        mul v18.8H, v2.8H, v0.H[0]              // ................................*...........
        mls v10.8H, v4.8H, v7.H[0]              // .................................*..........
        str q17, [x0, #288]                     // ..................................*.........
        mul v19.8H, v25.8H, v0.H[0]             // ...................................*........
        str q13, [x0, #432]                     // ....................................*.......
        mls v18.8H, v20.8H, v7.H[0]             // .....................................*......
        str q10, [x0, #368]                     // ......................................*.....
        mls v19.8H, v21.8H, v7.H[0]             // .......................................*....
        str q18, [x0, #304]                     // .........................................*..
        str q19, [x0, #240]                     // ...........................................*

                                                 // ------------ cycle (expected) ------------->
                                                 // 0                        25
                                                 // |------------------------|------------------
        // str q18, [x0, #240]                   // ..*.........................................
        // sqdmulh v24.8H, v23.8H, v7.H[1]       // ..........*.................................
        // sub v16.8H, v4.8H, v10.8H             // ...*........................................
        // srshr v4.8H, v24.8H, #11              // ..............*.............................
        // mls v23.8H, v4.8H, v7.H[0]            // .................*..........................
        // add v4.8H, v14.8H, v26.8H             // *...........................................
        // sub v22.8H, v23.8H, v20.8H            // ......................*.....................
        // add v24.8H, v23.8H, v20.8H            // .....................*......................
        // sqrdmulh v9.8H, v22.8H, v0.H[1]       // .............................*..............
        // mul v8.8H, v21.8H, v0.H[2]            // ....*.......................................
        // mul v23.8H, v6.8H, v0.H[0]            // ........*...................................
        // mul v18.8H, v22.8H, v0.H[0]           // ...................................*........
        // mls v23.8H, v12.8H, v7.H[0]           // ............*...............................
        // mul v11.8H, v16.8H, v0.H[0]           // ....................*.......................
        // str q23, [x0, #368]                   // .........................*..................
        // sqrdmulh v20.8H, v16.8H, v0.H[1]      // ...................*........................
        // str q24, [x0], #(16)                  // ...............................*............
        // mls v8.8H, v5.8H, v7.H[0]             // .........*..................................
        // mls v18.8H, v9.8H, v7.H[0]            // .......................................*....
        // mls v11.8H, v20.8H, v7.H[0]           // ..............................*.............
        // sub v6.8H, v8.8H, v17.8H              // ...............*............................
        // add v10.8H, v19.8H, v2.8H             // .*..........................................
        // add v15.8H, v8.8H, v17.8H             // .............*..............................
        // str q15, [x0, #112]                   // ...........................*................
        // str q11, [x0, #288]                   // ..................................*.........
        // add v11.8H, v4.8H, v10.8H             // ...........*................................
        // sqrdmulh v12.8H, v6.8H, v0.H[1]       // ........................*...................
        // sqrdmulh v28.8H, v13.8H, v0.H[1]      // ......*.....................................
        // mul v8.8H, v13.8H, v0.H[0]            // .......*....................................
        // str q3, [x0, #176]                    // .....*......................................
        // mls v8.8H, v28.8H, v7.H[0]            // ..................*.........................
        // str q11, [x0, #48]                    // .......................*....................
        // str q8, [x0, #432]                    // ....................................*.......
        // str q18, [x0, #240]                   // ...........................................*
        // sub v16.8H, v4.8H, v10.8H             // ................*...........................
        // mul v23.8H, v6.8H, v0.H[0]            // ............................*...............
        // mls v23.8H, v12.8H, v7.H[0]           // .................................*..........
        // mul v11.8H, v16.8H, v0.H[0]           // ................................*...........
        // str q23, [x0, #368]                   // ......................................*.....
        // sqrdmulh v20.8H, v16.8H, v0.H[1]      // ..........................*.................
        // mls v11.8H, v20.8H, v7.H[0]           // .....................................*......
        // str q11, [x0, #304]                   // .........................................*..


        pop_stack
        ret

/****************** REGISTER DEALLOCATIONS *******************/
    .unreq in
    .unreq r12345_ptr
    .unreq r67_ptr
    .unreq inp
    .unreq count
    .unreq wtmp
    .unreq data0
    .unreq data1
    .unreq data2
    .unreq data3
    .unreq data4
    .unreq data5
    .unreq data6
    .unreq data7
    .unreq q_data0
    .unreq q_data1
    .unreq q_data2
    .unreq q_data3
    .unreq q_data4
    .unreq q_data5
    .unreq q_data6
    .unreq q_data7
    .unreq root0
    .unreq root1
    .unreq root2
    .unreq root0_tw
    .unreq root1_tw
    .unreq root2_tw
    .unreq consts
    .unreq q_consts
    .unreq q_root0
    .unreq q_root1
    .unreq q_root2
    .unreq q_root0_tw
    .unreq q_root1_tw
    .unreq q_root2_tw
    .unreq tmp
    .unreq t0
    .unreq t1
    .unreq t2
    .unreq t3
    .unreq ninv
    .unreq ninv_tw

/* simpasm: footer-start */
#endif /* MLK_ARITH_BACKEND_AARCH64 && !MLK_CONFIG_MULTILEVEL_NO_SHARED */
